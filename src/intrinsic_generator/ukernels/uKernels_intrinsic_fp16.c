#include "uKernels_intrinsic_fp16.h"
#define Crref(i,j)  Cr[j*Clda+i]
#define vinit_fp16(vreg, value)   vreg = vmovq_n_f16(value)
#define vloadC_fp16(vreg, mem)    vreg=vld1q_f16(mem)
#define vstoreC_fp16(mem, vreg)   vst1q_f16(mem, vreg)
#define vload_fp16(vreg, mem) vreg=vld1q_f16(mem)
#define vupdate_lane_fp16(vreg1, vreg2, vreg3, lane) vreg1=vfmaq_laneq_f16(vreg1, vreg2, vreg3, lane)

void ukernel_intrinsic_8x8_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  B0;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
  } else {
    C00 = vld1q_f16(&Crref(0, 0));
    C01 = vld1q_f16(&Crref(0, 1));
    C02 = vld1q_f16(&Crref(0, 2));
    C03 = vld1q_f16(&Crref(0, 3));
    C04 = vld1q_f16(&Crref(0, 4));
    C05 = vld1q_f16(&Crref(0, 5));
    C06 = vld1q_f16(&Crref(0, 6));
    C07 = vld1q_f16(&Crref(0, 7));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(B0, &Br[bB + 0]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    bA+=8;
    bB+=8;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
}
void ukernel_intrinsic_8x16_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  B0,  B1;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    bA+=8;
    bB+=16;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
}
void ukernel_intrinsic_8x24_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  B0,  B1,  B2;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    bA+=8;
    bB+=24;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
}
void ukernel_intrinsic_8x32_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  B0,  B1,  B2,  B3;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    bA+=8;
    bB+=32;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
}
void ukernel_intrinsic_8x40_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  B0,  B1,  B2,  B3,  B4;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031,  C032,  C033,  C034,  C035,  C036,  C037,  C038,  C039;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
    vinit_fp16(C032, 0);
    vinit_fp16(C033, 0);
    vinit_fp16(C034, 0);
    vinit_fp16(C035, 0);
    vinit_fp16(C036, 0);
    vinit_fp16(C037, 0);
    vinit_fp16(C038, 0);
    vinit_fp16(C039, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
    vloadC_fp16(C032, &Crref(0, 32));
    vloadC_fp16(C033, &Crref(0, 33));
    vloadC_fp16(C034, &Crref(0, 34));
    vloadC_fp16(C035, &Crref(0, 35));
    vloadC_fp16(C036, &Crref(0, 36));
    vloadC_fp16(C037, &Crref(0, 37));
    vloadC_fp16(C038, &Crref(0, 38));
    vloadC_fp16(C039, &Crref(0, 39));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vload_fp16(B4, &Br[bB + 32]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    vupdate_lane_fp16(C032, A0, B4, 0); 
    vupdate_lane_fp16(C033, A0, B4, 1); 
    vupdate_lane_fp16(C034, A0, B4, 2); 
    vupdate_lane_fp16(C035, A0, B4, 3); 
    vupdate_lane_fp16(C036, A0, B4, 4); 
    vupdate_lane_fp16(C037, A0, B4, 5); 
    vupdate_lane_fp16(C038, A0, B4, 6); 
    vupdate_lane_fp16(C039, A0, B4, 7); 
    bA+=8;
    bB+=40;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
  vstoreC_fp16(&Crref(0,32), C032); 
  vstoreC_fp16(&Crref(0,33), C033); 
  vstoreC_fp16(&Crref(0,34), C034); 
  vstoreC_fp16(&Crref(0,35), C035); 
  vstoreC_fp16(&Crref(0,36), C036); 
  vstoreC_fp16(&Crref(0,37), C037); 
  vstoreC_fp16(&Crref(0,38), C038); 
  vstoreC_fp16(&Crref(0,39), C039); 
}
void ukernel_intrinsic_16x8_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  B0;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(B0, &Br[bB + 0]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    bA+=16;
    bB+=8;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
}
void ukernel_intrinsic_16x16_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  B0,  B1;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    bA+=16;
    bB+=16;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
}
void ukernel_intrinsic_16x24_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  B0,  B1,  B2;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    bA+=16;
    bB+=24;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
}
void ukernel_intrinsic_16x32_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  B0,  B1,  B2,  B3;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C124,  C125,  C126,  C127,  C128,  C129,  C130,  C131;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C124, 0);
    vinit_fp16(C125, 0);
    vinit_fp16(C126, 0);
    vinit_fp16(C127, 0);
    vinit_fp16(C128, 0);
    vinit_fp16(C129, 0);
    vinit_fp16(C130, 0);
    vinit_fp16(C131, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C124, &Crref(8, 24));
    vloadC_fp16(C125, &Crref(8, 25));
    vloadC_fp16(C126, &Crref(8, 26));
    vloadC_fp16(C127, &Crref(8, 27));
    vloadC_fp16(C128, &Crref(8, 28));
    vloadC_fp16(C129, &Crref(8, 29));
    vloadC_fp16(C130, &Crref(8, 30));
    vloadC_fp16(C131, &Crref(8, 31));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C124, A1, B3, 0); 
    vupdate_lane_fp16(C125, A1, B3, 1); 
    vupdate_lane_fp16(C126, A1, B3, 2); 
    vupdate_lane_fp16(C127, A1, B3, 3); 
    vupdate_lane_fp16(C128, A1, B3, 4); 
    vupdate_lane_fp16(C129, A1, B3, 5); 
    vupdate_lane_fp16(C130, A1, B3, 6); 
    vupdate_lane_fp16(C131, A1, B3, 7); 
    bA+=16;
    bB+=32;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(8,24), C124); 
  vstoreC_fp16(&Crref(8,25), C125); 
  vstoreC_fp16(&Crref(8,26), C126); 
  vstoreC_fp16(&Crref(8,27), C127); 
  vstoreC_fp16(&Crref(8,28), C128); 
  vstoreC_fp16(&Crref(8,29), C129); 
  vstoreC_fp16(&Crref(8,30), C130); 
  vstoreC_fp16(&Crref(8,31), C131); 
}
void ukernel_intrinsic_16x40_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  B0,  B1,  B2,  B3,  B4;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031,  C032,  C033,  C034,  C035,  C036,  C037,  C038,  C039,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C124,  C125,  C126,  C127,  C128,  C129,  C130,  C131,  C132,  C133,  C134,  C135,  C136,  C137,  C138,  C139;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
    vinit_fp16(C032, 0);
    vinit_fp16(C033, 0);
    vinit_fp16(C034, 0);
    vinit_fp16(C035, 0);
    vinit_fp16(C036, 0);
    vinit_fp16(C037, 0);
    vinit_fp16(C038, 0);
    vinit_fp16(C039, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C124, 0);
    vinit_fp16(C125, 0);
    vinit_fp16(C126, 0);
    vinit_fp16(C127, 0);
    vinit_fp16(C128, 0);
    vinit_fp16(C129, 0);
    vinit_fp16(C130, 0);
    vinit_fp16(C131, 0);
    vinit_fp16(C132, 0);
    vinit_fp16(C133, 0);
    vinit_fp16(C134, 0);
    vinit_fp16(C135, 0);
    vinit_fp16(C136, 0);
    vinit_fp16(C137, 0);
    vinit_fp16(C138, 0);
    vinit_fp16(C139, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
    vloadC_fp16(C032, &Crref(0, 32));
    vloadC_fp16(C033, &Crref(0, 33));
    vloadC_fp16(C034, &Crref(0, 34));
    vloadC_fp16(C035, &Crref(0, 35));
    vloadC_fp16(C036, &Crref(0, 36));
    vloadC_fp16(C037, &Crref(0, 37));
    vloadC_fp16(C038, &Crref(0, 38));
    vloadC_fp16(C039, &Crref(0, 39));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C124, &Crref(8, 24));
    vloadC_fp16(C125, &Crref(8, 25));
    vloadC_fp16(C126, &Crref(8, 26));
    vloadC_fp16(C127, &Crref(8, 27));
    vloadC_fp16(C128, &Crref(8, 28));
    vloadC_fp16(C129, &Crref(8, 29));
    vloadC_fp16(C130, &Crref(8, 30));
    vloadC_fp16(C131, &Crref(8, 31));
    vloadC_fp16(C132, &Crref(8, 32));
    vloadC_fp16(C133, &Crref(8, 33));
    vloadC_fp16(C134, &Crref(8, 34));
    vloadC_fp16(C135, &Crref(8, 35));
    vloadC_fp16(C136, &Crref(8, 36));
    vloadC_fp16(C137, &Crref(8, 37));
    vloadC_fp16(C138, &Crref(8, 38));
    vloadC_fp16(C139, &Crref(8, 39));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vload_fp16(B4, &Br[bB + 32]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    vupdate_lane_fp16(C032, A0, B4, 0); 
    vupdate_lane_fp16(C033, A0, B4, 1); 
    vupdate_lane_fp16(C034, A0, B4, 2); 
    vupdate_lane_fp16(C035, A0, B4, 3); 
    vupdate_lane_fp16(C036, A0, B4, 4); 
    vupdate_lane_fp16(C037, A0, B4, 5); 
    vupdate_lane_fp16(C038, A0, B4, 6); 
    vupdate_lane_fp16(C039, A0, B4, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C124, A1, B3, 0); 
    vupdate_lane_fp16(C125, A1, B3, 1); 
    vupdate_lane_fp16(C126, A1, B3, 2); 
    vupdate_lane_fp16(C127, A1, B3, 3); 
    vupdate_lane_fp16(C128, A1, B3, 4); 
    vupdate_lane_fp16(C129, A1, B3, 5); 
    vupdate_lane_fp16(C130, A1, B3, 6); 
    vupdate_lane_fp16(C131, A1, B3, 7); 
    vupdate_lane_fp16(C132, A1, B4, 0); 
    vupdate_lane_fp16(C133, A1, B4, 1); 
    vupdate_lane_fp16(C134, A1, B4, 2); 
    vupdate_lane_fp16(C135, A1, B4, 3); 
    vupdate_lane_fp16(C136, A1, B4, 4); 
    vupdate_lane_fp16(C137, A1, B4, 5); 
    vupdate_lane_fp16(C138, A1, B4, 6); 
    vupdate_lane_fp16(C139, A1, B4, 7); 
    bA+=16;
    bB+=40;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
  vstoreC_fp16(&Crref(0,32), C032); 
  vstoreC_fp16(&Crref(0,33), C033); 
  vstoreC_fp16(&Crref(0,34), C034); 
  vstoreC_fp16(&Crref(0,35), C035); 
  vstoreC_fp16(&Crref(0,36), C036); 
  vstoreC_fp16(&Crref(0,37), C037); 
  vstoreC_fp16(&Crref(0,38), C038); 
  vstoreC_fp16(&Crref(0,39), C039); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(8,24), C124); 
  vstoreC_fp16(&Crref(8,25), C125); 
  vstoreC_fp16(&Crref(8,26), C126); 
  vstoreC_fp16(&Crref(8,27), C127); 
  vstoreC_fp16(&Crref(8,28), C128); 
  vstoreC_fp16(&Crref(8,29), C129); 
  vstoreC_fp16(&Crref(8,30), C130); 
  vstoreC_fp16(&Crref(8,31), C131); 
  vstoreC_fp16(&Crref(8,32), C132); 
  vstoreC_fp16(&Crref(8,33), C133); 
  vstoreC_fp16(&Crref(8,34), C134); 
  vstoreC_fp16(&Crref(8,35), C135); 
  vstoreC_fp16(&Crref(8,36), C136); 
  vstoreC_fp16(&Crref(8,37), C137); 
  vstoreC_fp16(&Crref(8,38), C138); 
  vstoreC_fp16(&Crref(8,39), C139); 
}
void ukernel_intrinsic_24x8_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  B0;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(B0, &Br[bB + 0]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    bA+=24;
    bB+=8;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
}
void ukernel_intrinsic_24x16_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  B0,  B1;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    bA+=24;
    bB+=16;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
}
void ukernel_intrinsic_24x24_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  B0,  B1,  B2;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C216,  C217,  C218,  C219,  C220,  C221,  C222,  C223;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C216, 0);
    vinit_fp16(C217, 0);
    vinit_fp16(C218, 0);
    vinit_fp16(C219, 0);
    vinit_fp16(C220, 0);
    vinit_fp16(C221, 0);
    vinit_fp16(C222, 0);
    vinit_fp16(C223, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C216, &Crref(16, 16));
    vloadC_fp16(C217, &Crref(16, 17));
    vloadC_fp16(C218, &Crref(16, 18));
    vloadC_fp16(C219, &Crref(16, 19));
    vloadC_fp16(C220, &Crref(16, 20));
    vloadC_fp16(C221, &Crref(16, 21));
    vloadC_fp16(C222, &Crref(16, 22));
    vloadC_fp16(C223, &Crref(16, 23));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C216, A2, B2, 0); 
    vupdate_lane_fp16(C217, A2, B2, 1); 
    vupdate_lane_fp16(C218, A2, B2, 2); 
    vupdate_lane_fp16(C219, A2, B2, 3); 
    vupdate_lane_fp16(C220, A2, B2, 4); 
    vupdate_lane_fp16(C221, A2, B2, 5); 
    vupdate_lane_fp16(C222, A2, B2, 6); 
    vupdate_lane_fp16(C223, A2, B2, 7); 
    bA+=24;
    bB+=24;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(16,16), C216); 
  vstoreC_fp16(&Crref(16,17), C217); 
  vstoreC_fp16(&Crref(16,18), C218); 
  vstoreC_fp16(&Crref(16,19), C219); 
  vstoreC_fp16(&Crref(16,20), C220); 
  vstoreC_fp16(&Crref(16,21), C221); 
  vstoreC_fp16(&Crref(16,22), C222); 
  vstoreC_fp16(&Crref(16,23), C223); 
}
void ukernel_intrinsic_24x32_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  B0,  B1,  B2,  B3;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C124,  C125,  C126,  C127,  C128,  C129,  C130,  C131,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C216,  C217,  C218,  C219,  C220,  C221,  C222,  C223,  C224,  C225,  C226,  C227,  C228,  C229,  C230,  C231;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C124, 0);
    vinit_fp16(C125, 0);
    vinit_fp16(C126, 0);
    vinit_fp16(C127, 0);
    vinit_fp16(C128, 0);
    vinit_fp16(C129, 0);
    vinit_fp16(C130, 0);
    vinit_fp16(C131, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C216, 0);
    vinit_fp16(C217, 0);
    vinit_fp16(C218, 0);
    vinit_fp16(C219, 0);
    vinit_fp16(C220, 0);
    vinit_fp16(C221, 0);
    vinit_fp16(C222, 0);
    vinit_fp16(C223, 0);
    vinit_fp16(C224, 0);
    vinit_fp16(C225, 0);
    vinit_fp16(C226, 0);
    vinit_fp16(C227, 0);
    vinit_fp16(C228, 0);
    vinit_fp16(C229, 0);
    vinit_fp16(C230, 0);
    vinit_fp16(C231, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C124, &Crref(8, 24));
    vloadC_fp16(C125, &Crref(8, 25));
    vloadC_fp16(C126, &Crref(8, 26));
    vloadC_fp16(C127, &Crref(8, 27));
    vloadC_fp16(C128, &Crref(8, 28));
    vloadC_fp16(C129, &Crref(8, 29));
    vloadC_fp16(C130, &Crref(8, 30));
    vloadC_fp16(C131, &Crref(8, 31));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C216, &Crref(16, 16));
    vloadC_fp16(C217, &Crref(16, 17));
    vloadC_fp16(C218, &Crref(16, 18));
    vloadC_fp16(C219, &Crref(16, 19));
    vloadC_fp16(C220, &Crref(16, 20));
    vloadC_fp16(C221, &Crref(16, 21));
    vloadC_fp16(C222, &Crref(16, 22));
    vloadC_fp16(C223, &Crref(16, 23));
    vloadC_fp16(C224, &Crref(16, 24));
    vloadC_fp16(C225, &Crref(16, 25));
    vloadC_fp16(C226, &Crref(16, 26));
    vloadC_fp16(C227, &Crref(16, 27));
    vloadC_fp16(C228, &Crref(16, 28));
    vloadC_fp16(C229, &Crref(16, 29));
    vloadC_fp16(C230, &Crref(16, 30));
    vloadC_fp16(C231, &Crref(16, 31));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C124, A1, B3, 0); 
    vupdate_lane_fp16(C125, A1, B3, 1); 
    vupdate_lane_fp16(C126, A1, B3, 2); 
    vupdate_lane_fp16(C127, A1, B3, 3); 
    vupdate_lane_fp16(C128, A1, B3, 4); 
    vupdate_lane_fp16(C129, A1, B3, 5); 
    vupdate_lane_fp16(C130, A1, B3, 6); 
    vupdate_lane_fp16(C131, A1, B3, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C216, A2, B2, 0); 
    vupdate_lane_fp16(C217, A2, B2, 1); 
    vupdate_lane_fp16(C218, A2, B2, 2); 
    vupdate_lane_fp16(C219, A2, B2, 3); 
    vupdate_lane_fp16(C220, A2, B2, 4); 
    vupdate_lane_fp16(C221, A2, B2, 5); 
    vupdate_lane_fp16(C222, A2, B2, 6); 
    vupdate_lane_fp16(C223, A2, B2, 7); 
    vupdate_lane_fp16(C224, A2, B3, 0); 
    vupdate_lane_fp16(C225, A2, B3, 1); 
    vupdate_lane_fp16(C226, A2, B3, 2); 
    vupdate_lane_fp16(C227, A2, B3, 3); 
    vupdate_lane_fp16(C228, A2, B3, 4); 
    vupdate_lane_fp16(C229, A2, B3, 5); 
    vupdate_lane_fp16(C230, A2, B3, 6); 
    vupdate_lane_fp16(C231, A2, B3, 7); 
    bA+=24;
    bB+=32;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(8,24), C124); 
  vstoreC_fp16(&Crref(8,25), C125); 
  vstoreC_fp16(&Crref(8,26), C126); 
  vstoreC_fp16(&Crref(8,27), C127); 
  vstoreC_fp16(&Crref(8,28), C128); 
  vstoreC_fp16(&Crref(8,29), C129); 
  vstoreC_fp16(&Crref(8,30), C130); 
  vstoreC_fp16(&Crref(8,31), C131); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(16,16), C216); 
  vstoreC_fp16(&Crref(16,17), C217); 
  vstoreC_fp16(&Crref(16,18), C218); 
  vstoreC_fp16(&Crref(16,19), C219); 
  vstoreC_fp16(&Crref(16,20), C220); 
  vstoreC_fp16(&Crref(16,21), C221); 
  vstoreC_fp16(&Crref(16,22), C222); 
  vstoreC_fp16(&Crref(16,23), C223); 
  vstoreC_fp16(&Crref(16,24), C224); 
  vstoreC_fp16(&Crref(16,25), C225); 
  vstoreC_fp16(&Crref(16,26), C226); 
  vstoreC_fp16(&Crref(16,27), C227); 
  vstoreC_fp16(&Crref(16,28), C228); 
  vstoreC_fp16(&Crref(16,29), C229); 
  vstoreC_fp16(&Crref(16,30), C230); 
  vstoreC_fp16(&Crref(16,31), C231); 
}
void ukernel_intrinsic_24x40_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  B0,  B1,  B2,  B3,  B4;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031,  C032,  C033,  C034,  C035,  C036,  C037,  C038,  C039,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C124,  C125,  C126,  C127,  C128,  C129,  C130,  C131,  C132,  C133,  C134,  C135,  C136,  C137,  C138,  C139,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C216,  C217,  C218,  C219,  C220,  C221,  C222,  C223,  C224,  C225,  C226,  C227,  C228,  C229,  C230,  C231,  C232,  C233,  C234,  C235,  C236,  C237,  C238,  C239;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
    vinit_fp16(C032, 0);
    vinit_fp16(C033, 0);
    vinit_fp16(C034, 0);
    vinit_fp16(C035, 0);
    vinit_fp16(C036, 0);
    vinit_fp16(C037, 0);
    vinit_fp16(C038, 0);
    vinit_fp16(C039, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C124, 0);
    vinit_fp16(C125, 0);
    vinit_fp16(C126, 0);
    vinit_fp16(C127, 0);
    vinit_fp16(C128, 0);
    vinit_fp16(C129, 0);
    vinit_fp16(C130, 0);
    vinit_fp16(C131, 0);
    vinit_fp16(C132, 0);
    vinit_fp16(C133, 0);
    vinit_fp16(C134, 0);
    vinit_fp16(C135, 0);
    vinit_fp16(C136, 0);
    vinit_fp16(C137, 0);
    vinit_fp16(C138, 0);
    vinit_fp16(C139, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C216, 0);
    vinit_fp16(C217, 0);
    vinit_fp16(C218, 0);
    vinit_fp16(C219, 0);
    vinit_fp16(C220, 0);
    vinit_fp16(C221, 0);
    vinit_fp16(C222, 0);
    vinit_fp16(C223, 0);
    vinit_fp16(C224, 0);
    vinit_fp16(C225, 0);
    vinit_fp16(C226, 0);
    vinit_fp16(C227, 0);
    vinit_fp16(C228, 0);
    vinit_fp16(C229, 0);
    vinit_fp16(C230, 0);
    vinit_fp16(C231, 0);
    vinit_fp16(C232, 0);
    vinit_fp16(C233, 0);
    vinit_fp16(C234, 0);
    vinit_fp16(C235, 0);
    vinit_fp16(C236, 0);
    vinit_fp16(C237, 0);
    vinit_fp16(C238, 0);
    vinit_fp16(C239, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
    vloadC_fp16(C032, &Crref(0, 32));
    vloadC_fp16(C033, &Crref(0, 33));
    vloadC_fp16(C034, &Crref(0, 34));
    vloadC_fp16(C035, &Crref(0, 35));
    vloadC_fp16(C036, &Crref(0, 36));
    vloadC_fp16(C037, &Crref(0, 37));
    vloadC_fp16(C038, &Crref(0, 38));
    vloadC_fp16(C039, &Crref(0, 39));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C124, &Crref(8, 24));
    vloadC_fp16(C125, &Crref(8, 25));
    vloadC_fp16(C126, &Crref(8, 26));
    vloadC_fp16(C127, &Crref(8, 27));
    vloadC_fp16(C128, &Crref(8, 28));
    vloadC_fp16(C129, &Crref(8, 29));
    vloadC_fp16(C130, &Crref(8, 30));
    vloadC_fp16(C131, &Crref(8, 31));
    vloadC_fp16(C132, &Crref(8, 32));
    vloadC_fp16(C133, &Crref(8, 33));
    vloadC_fp16(C134, &Crref(8, 34));
    vloadC_fp16(C135, &Crref(8, 35));
    vloadC_fp16(C136, &Crref(8, 36));
    vloadC_fp16(C137, &Crref(8, 37));
    vloadC_fp16(C138, &Crref(8, 38));
    vloadC_fp16(C139, &Crref(8, 39));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C216, &Crref(16, 16));
    vloadC_fp16(C217, &Crref(16, 17));
    vloadC_fp16(C218, &Crref(16, 18));
    vloadC_fp16(C219, &Crref(16, 19));
    vloadC_fp16(C220, &Crref(16, 20));
    vloadC_fp16(C221, &Crref(16, 21));
    vloadC_fp16(C222, &Crref(16, 22));
    vloadC_fp16(C223, &Crref(16, 23));
    vloadC_fp16(C224, &Crref(16, 24));
    vloadC_fp16(C225, &Crref(16, 25));
    vloadC_fp16(C226, &Crref(16, 26));
    vloadC_fp16(C227, &Crref(16, 27));
    vloadC_fp16(C228, &Crref(16, 28));
    vloadC_fp16(C229, &Crref(16, 29));
    vloadC_fp16(C230, &Crref(16, 30));
    vloadC_fp16(C231, &Crref(16, 31));
    vloadC_fp16(C232, &Crref(16, 32));
    vloadC_fp16(C233, &Crref(16, 33));
    vloadC_fp16(C234, &Crref(16, 34));
    vloadC_fp16(C235, &Crref(16, 35));
    vloadC_fp16(C236, &Crref(16, 36));
    vloadC_fp16(C237, &Crref(16, 37));
    vloadC_fp16(C238, &Crref(16, 38));
    vloadC_fp16(C239, &Crref(16, 39));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vload_fp16(B4, &Br[bB + 32]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    vupdate_lane_fp16(C032, A0, B4, 0); 
    vupdate_lane_fp16(C033, A0, B4, 1); 
    vupdate_lane_fp16(C034, A0, B4, 2); 
    vupdate_lane_fp16(C035, A0, B4, 3); 
    vupdate_lane_fp16(C036, A0, B4, 4); 
    vupdate_lane_fp16(C037, A0, B4, 5); 
    vupdate_lane_fp16(C038, A0, B4, 6); 
    vupdate_lane_fp16(C039, A0, B4, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C124, A1, B3, 0); 
    vupdate_lane_fp16(C125, A1, B3, 1); 
    vupdate_lane_fp16(C126, A1, B3, 2); 
    vupdate_lane_fp16(C127, A1, B3, 3); 
    vupdate_lane_fp16(C128, A1, B3, 4); 
    vupdate_lane_fp16(C129, A1, B3, 5); 
    vupdate_lane_fp16(C130, A1, B3, 6); 
    vupdate_lane_fp16(C131, A1, B3, 7); 
    vupdate_lane_fp16(C132, A1, B4, 0); 
    vupdate_lane_fp16(C133, A1, B4, 1); 
    vupdate_lane_fp16(C134, A1, B4, 2); 
    vupdate_lane_fp16(C135, A1, B4, 3); 
    vupdate_lane_fp16(C136, A1, B4, 4); 
    vupdate_lane_fp16(C137, A1, B4, 5); 
    vupdate_lane_fp16(C138, A1, B4, 6); 
    vupdate_lane_fp16(C139, A1, B4, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C216, A2, B2, 0); 
    vupdate_lane_fp16(C217, A2, B2, 1); 
    vupdate_lane_fp16(C218, A2, B2, 2); 
    vupdate_lane_fp16(C219, A2, B2, 3); 
    vupdate_lane_fp16(C220, A2, B2, 4); 
    vupdate_lane_fp16(C221, A2, B2, 5); 
    vupdate_lane_fp16(C222, A2, B2, 6); 
    vupdate_lane_fp16(C223, A2, B2, 7); 
    vupdate_lane_fp16(C224, A2, B3, 0); 
    vupdate_lane_fp16(C225, A2, B3, 1); 
    vupdate_lane_fp16(C226, A2, B3, 2); 
    vupdate_lane_fp16(C227, A2, B3, 3); 
    vupdate_lane_fp16(C228, A2, B3, 4); 
    vupdate_lane_fp16(C229, A2, B3, 5); 
    vupdate_lane_fp16(C230, A2, B3, 6); 
    vupdate_lane_fp16(C231, A2, B3, 7); 
    vupdate_lane_fp16(C232, A2, B4, 0); 
    vupdate_lane_fp16(C233, A2, B4, 1); 
    vupdate_lane_fp16(C234, A2, B4, 2); 
    vupdate_lane_fp16(C235, A2, B4, 3); 
    vupdate_lane_fp16(C236, A2, B4, 4); 
    vupdate_lane_fp16(C237, A2, B4, 5); 
    vupdate_lane_fp16(C238, A2, B4, 6); 
    vupdate_lane_fp16(C239, A2, B4, 7); 
    bA+=24;
    bB+=40;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
  vstoreC_fp16(&Crref(0,32), C032); 
  vstoreC_fp16(&Crref(0,33), C033); 
  vstoreC_fp16(&Crref(0,34), C034); 
  vstoreC_fp16(&Crref(0,35), C035); 
  vstoreC_fp16(&Crref(0,36), C036); 
  vstoreC_fp16(&Crref(0,37), C037); 
  vstoreC_fp16(&Crref(0,38), C038); 
  vstoreC_fp16(&Crref(0,39), C039); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(8,24), C124); 
  vstoreC_fp16(&Crref(8,25), C125); 
  vstoreC_fp16(&Crref(8,26), C126); 
  vstoreC_fp16(&Crref(8,27), C127); 
  vstoreC_fp16(&Crref(8,28), C128); 
  vstoreC_fp16(&Crref(8,29), C129); 
  vstoreC_fp16(&Crref(8,30), C130); 
  vstoreC_fp16(&Crref(8,31), C131); 
  vstoreC_fp16(&Crref(8,32), C132); 
  vstoreC_fp16(&Crref(8,33), C133); 
  vstoreC_fp16(&Crref(8,34), C134); 
  vstoreC_fp16(&Crref(8,35), C135); 
  vstoreC_fp16(&Crref(8,36), C136); 
  vstoreC_fp16(&Crref(8,37), C137); 
  vstoreC_fp16(&Crref(8,38), C138); 
  vstoreC_fp16(&Crref(8,39), C139); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(16,16), C216); 
  vstoreC_fp16(&Crref(16,17), C217); 
  vstoreC_fp16(&Crref(16,18), C218); 
  vstoreC_fp16(&Crref(16,19), C219); 
  vstoreC_fp16(&Crref(16,20), C220); 
  vstoreC_fp16(&Crref(16,21), C221); 
  vstoreC_fp16(&Crref(16,22), C222); 
  vstoreC_fp16(&Crref(16,23), C223); 
  vstoreC_fp16(&Crref(16,24), C224); 
  vstoreC_fp16(&Crref(16,25), C225); 
  vstoreC_fp16(&Crref(16,26), C226); 
  vstoreC_fp16(&Crref(16,27), C227); 
  vstoreC_fp16(&Crref(16,28), C228); 
  vstoreC_fp16(&Crref(16,29), C229); 
  vstoreC_fp16(&Crref(16,30), C230); 
  vstoreC_fp16(&Crref(16,31), C231); 
  vstoreC_fp16(&Crref(16,32), C232); 
  vstoreC_fp16(&Crref(16,33), C233); 
  vstoreC_fp16(&Crref(16,34), C234); 
  vstoreC_fp16(&Crref(16,35), C235); 
  vstoreC_fp16(&Crref(16,36), C236); 
  vstoreC_fp16(&Crref(16,37), C237); 
  vstoreC_fp16(&Crref(16,38), C238); 
  vstoreC_fp16(&Crref(16,39), C239); 
}
void ukernel_intrinsic_32x8_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  B0;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(B0, &Br[bB + 0]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    bA+=32;
    bB+=8;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
}
void ukernel_intrinsic_32x16_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  B0,  B1;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37,  C38,  C39,  C310,  C311,  C312,  C313,  C314,  C315;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
    vinit_fp16(C38, 0);
    vinit_fp16(C39, 0);
    vinit_fp16(C310, 0);
    vinit_fp16(C311, 0);
    vinit_fp16(C312, 0);
    vinit_fp16(C313, 0);
    vinit_fp16(C314, 0);
    vinit_fp16(C315, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
    vloadC_fp16(C38, &Crref(24, 8));
    vloadC_fp16(C39, &Crref(24, 9));
    vloadC_fp16(C310, &Crref(24, 10));
    vloadC_fp16(C311, &Crref(24, 11));
    vloadC_fp16(C312, &Crref(24, 12));
    vloadC_fp16(C313, &Crref(24, 13));
    vloadC_fp16(C314, &Crref(24, 14));
    vloadC_fp16(C315, &Crref(24, 15));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    vupdate_lane_fp16(C38, A3, B1, 0); 
    vupdate_lane_fp16(C39, A3, B1, 1); 
    vupdate_lane_fp16(C310, A3, B1, 2); 
    vupdate_lane_fp16(C311, A3, B1, 3); 
    vupdate_lane_fp16(C312, A3, B1, 4); 
    vupdate_lane_fp16(C313, A3, B1, 5); 
    vupdate_lane_fp16(C314, A3, B1, 6); 
    vupdate_lane_fp16(C315, A3, B1, 7); 
    bA+=32;
    bB+=16;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
  vstoreC_fp16(&Crref(24,8), C38); 
  vstoreC_fp16(&Crref(24,9), C39); 
  vstoreC_fp16(&Crref(24,10), C310); 
  vstoreC_fp16(&Crref(24,11), C311); 
  vstoreC_fp16(&Crref(24,12), C312); 
  vstoreC_fp16(&Crref(24,13), C313); 
  vstoreC_fp16(&Crref(24,14), C314); 
  vstoreC_fp16(&Crref(24,15), C315); 
}
void ukernel_intrinsic_32x24_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  B0,  B1,  B2;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C216,  C217,  C218,  C219,  C220,  C221,  C222,  C223,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37,  C38,  C39,  C310,  C311,  C312,  C313,  C314,  C315,  C316,  C317,  C318,  C319,  C320,  C321,  C322,  C323;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C216, 0);
    vinit_fp16(C217, 0);
    vinit_fp16(C218, 0);
    vinit_fp16(C219, 0);
    vinit_fp16(C220, 0);
    vinit_fp16(C221, 0);
    vinit_fp16(C222, 0);
    vinit_fp16(C223, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
    vinit_fp16(C38, 0);
    vinit_fp16(C39, 0);
    vinit_fp16(C310, 0);
    vinit_fp16(C311, 0);
    vinit_fp16(C312, 0);
    vinit_fp16(C313, 0);
    vinit_fp16(C314, 0);
    vinit_fp16(C315, 0);
    vinit_fp16(C316, 0);
    vinit_fp16(C317, 0);
    vinit_fp16(C318, 0);
    vinit_fp16(C319, 0);
    vinit_fp16(C320, 0);
    vinit_fp16(C321, 0);
    vinit_fp16(C322, 0);
    vinit_fp16(C323, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C216, &Crref(16, 16));
    vloadC_fp16(C217, &Crref(16, 17));
    vloadC_fp16(C218, &Crref(16, 18));
    vloadC_fp16(C219, &Crref(16, 19));
    vloadC_fp16(C220, &Crref(16, 20));
    vloadC_fp16(C221, &Crref(16, 21));
    vloadC_fp16(C222, &Crref(16, 22));
    vloadC_fp16(C223, &Crref(16, 23));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
    vloadC_fp16(C38, &Crref(24, 8));
    vloadC_fp16(C39, &Crref(24, 9));
    vloadC_fp16(C310, &Crref(24, 10));
    vloadC_fp16(C311, &Crref(24, 11));
    vloadC_fp16(C312, &Crref(24, 12));
    vloadC_fp16(C313, &Crref(24, 13));
    vloadC_fp16(C314, &Crref(24, 14));
    vloadC_fp16(C315, &Crref(24, 15));
    vloadC_fp16(C316, &Crref(24, 16));
    vloadC_fp16(C317, &Crref(24, 17));
    vloadC_fp16(C318, &Crref(24, 18));
    vloadC_fp16(C319, &Crref(24, 19));
    vloadC_fp16(C320, &Crref(24, 20));
    vloadC_fp16(C321, &Crref(24, 21));
    vloadC_fp16(C322, &Crref(24, 22));
    vloadC_fp16(C323, &Crref(24, 23));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C216, A2, B2, 0); 
    vupdate_lane_fp16(C217, A2, B2, 1); 
    vupdate_lane_fp16(C218, A2, B2, 2); 
    vupdate_lane_fp16(C219, A2, B2, 3); 
    vupdate_lane_fp16(C220, A2, B2, 4); 
    vupdate_lane_fp16(C221, A2, B2, 5); 
    vupdate_lane_fp16(C222, A2, B2, 6); 
    vupdate_lane_fp16(C223, A2, B2, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    vupdate_lane_fp16(C38, A3, B1, 0); 
    vupdate_lane_fp16(C39, A3, B1, 1); 
    vupdate_lane_fp16(C310, A3, B1, 2); 
    vupdate_lane_fp16(C311, A3, B1, 3); 
    vupdate_lane_fp16(C312, A3, B1, 4); 
    vupdate_lane_fp16(C313, A3, B1, 5); 
    vupdate_lane_fp16(C314, A3, B1, 6); 
    vupdate_lane_fp16(C315, A3, B1, 7); 
    vupdate_lane_fp16(C316, A3, B2, 0); 
    vupdate_lane_fp16(C317, A3, B2, 1); 
    vupdate_lane_fp16(C318, A3, B2, 2); 
    vupdate_lane_fp16(C319, A3, B2, 3); 
    vupdate_lane_fp16(C320, A3, B2, 4); 
    vupdate_lane_fp16(C321, A3, B2, 5); 
    vupdate_lane_fp16(C322, A3, B2, 6); 
    vupdate_lane_fp16(C323, A3, B2, 7); 
    bA+=32;
    bB+=24;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(16,16), C216); 
  vstoreC_fp16(&Crref(16,17), C217); 
  vstoreC_fp16(&Crref(16,18), C218); 
  vstoreC_fp16(&Crref(16,19), C219); 
  vstoreC_fp16(&Crref(16,20), C220); 
  vstoreC_fp16(&Crref(16,21), C221); 
  vstoreC_fp16(&Crref(16,22), C222); 
  vstoreC_fp16(&Crref(16,23), C223); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
  vstoreC_fp16(&Crref(24,8), C38); 
  vstoreC_fp16(&Crref(24,9), C39); 
  vstoreC_fp16(&Crref(24,10), C310); 
  vstoreC_fp16(&Crref(24,11), C311); 
  vstoreC_fp16(&Crref(24,12), C312); 
  vstoreC_fp16(&Crref(24,13), C313); 
  vstoreC_fp16(&Crref(24,14), C314); 
  vstoreC_fp16(&Crref(24,15), C315); 
  vstoreC_fp16(&Crref(24,16), C316); 
  vstoreC_fp16(&Crref(24,17), C317); 
  vstoreC_fp16(&Crref(24,18), C318); 
  vstoreC_fp16(&Crref(24,19), C319); 
  vstoreC_fp16(&Crref(24,20), C320); 
  vstoreC_fp16(&Crref(24,21), C321); 
  vstoreC_fp16(&Crref(24,22), C322); 
  vstoreC_fp16(&Crref(24,23), C323); 
}
void ukernel_intrinsic_32x32_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  B0,  B1,  B2,  B3;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C124,  C125,  C126,  C127,  C128,  C129,  C130,  C131,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C216,  C217,  C218,  C219,  C220,  C221,  C222,  C223,  C224,  C225,  C226,  C227,  C228,  C229,  C230,  C231,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37,  C38,  C39,  C310,  C311,  C312,  C313,  C314,  C315,  C316,  C317,  C318,  C319,  C320,  C321,  C322,  C323,  C324,  C325,  C326,  C327,  C328,  C329,  C330,  C331;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C124, 0);
    vinit_fp16(C125, 0);
    vinit_fp16(C126, 0);
    vinit_fp16(C127, 0);
    vinit_fp16(C128, 0);
    vinit_fp16(C129, 0);
    vinit_fp16(C130, 0);
    vinit_fp16(C131, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C216, 0);
    vinit_fp16(C217, 0);
    vinit_fp16(C218, 0);
    vinit_fp16(C219, 0);
    vinit_fp16(C220, 0);
    vinit_fp16(C221, 0);
    vinit_fp16(C222, 0);
    vinit_fp16(C223, 0);
    vinit_fp16(C224, 0);
    vinit_fp16(C225, 0);
    vinit_fp16(C226, 0);
    vinit_fp16(C227, 0);
    vinit_fp16(C228, 0);
    vinit_fp16(C229, 0);
    vinit_fp16(C230, 0);
    vinit_fp16(C231, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
    vinit_fp16(C38, 0);
    vinit_fp16(C39, 0);
    vinit_fp16(C310, 0);
    vinit_fp16(C311, 0);
    vinit_fp16(C312, 0);
    vinit_fp16(C313, 0);
    vinit_fp16(C314, 0);
    vinit_fp16(C315, 0);
    vinit_fp16(C316, 0);
    vinit_fp16(C317, 0);
    vinit_fp16(C318, 0);
    vinit_fp16(C319, 0);
    vinit_fp16(C320, 0);
    vinit_fp16(C321, 0);
    vinit_fp16(C322, 0);
    vinit_fp16(C323, 0);
    vinit_fp16(C324, 0);
    vinit_fp16(C325, 0);
    vinit_fp16(C326, 0);
    vinit_fp16(C327, 0);
    vinit_fp16(C328, 0);
    vinit_fp16(C329, 0);
    vinit_fp16(C330, 0);
    vinit_fp16(C331, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C124, &Crref(8, 24));
    vloadC_fp16(C125, &Crref(8, 25));
    vloadC_fp16(C126, &Crref(8, 26));
    vloadC_fp16(C127, &Crref(8, 27));
    vloadC_fp16(C128, &Crref(8, 28));
    vloadC_fp16(C129, &Crref(8, 29));
    vloadC_fp16(C130, &Crref(8, 30));
    vloadC_fp16(C131, &Crref(8, 31));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C216, &Crref(16, 16));
    vloadC_fp16(C217, &Crref(16, 17));
    vloadC_fp16(C218, &Crref(16, 18));
    vloadC_fp16(C219, &Crref(16, 19));
    vloadC_fp16(C220, &Crref(16, 20));
    vloadC_fp16(C221, &Crref(16, 21));
    vloadC_fp16(C222, &Crref(16, 22));
    vloadC_fp16(C223, &Crref(16, 23));
    vloadC_fp16(C224, &Crref(16, 24));
    vloadC_fp16(C225, &Crref(16, 25));
    vloadC_fp16(C226, &Crref(16, 26));
    vloadC_fp16(C227, &Crref(16, 27));
    vloadC_fp16(C228, &Crref(16, 28));
    vloadC_fp16(C229, &Crref(16, 29));
    vloadC_fp16(C230, &Crref(16, 30));
    vloadC_fp16(C231, &Crref(16, 31));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
    vloadC_fp16(C38, &Crref(24, 8));
    vloadC_fp16(C39, &Crref(24, 9));
    vloadC_fp16(C310, &Crref(24, 10));
    vloadC_fp16(C311, &Crref(24, 11));
    vloadC_fp16(C312, &Crref(24, 12));
    vloadC_fp16(C313, &Crref(24, 13));
    vloadC_fp16(C314, &Crref(24, 14));
    vloadC_fp16(C315, &Crref(24, 15));
    vloadC_fp16(C316, &Crref(24, 16));
    vloadC_fp16(C317, &Crref(24, 17));
    vloadC_fp16(C318, &Crref(24, 18));
    vloadC_fp16(C319, &Crref(24, 19));
    vloadC_fp16(C320, &Crref(24, 20));
    vloadC_fp16(C321, &Crref(24, 21));
    vloadC_fp16(C322, &Crref(24, 22));
    vloadC_fp16(C323, &Crref(24, 23));
    vloadC_fp16(C324, &Crref(24, 24));
    vloadC_fp16(C325, &Crref(24, 25));
    vloadC_fp16(C326, &Crref(24, 26));
    vloadC_fp16(C327, &Crref(24, 27));
    vloadC_fp16(C328, &Crref(24, 28));
    vloadC_fp16(C329, &Crref(24, 29));
    vloadC_fp16(C330, &Crref(24, 30));
    vloadC_fp16(C331, &Crref(24, 31));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C124, A1, B3, 0); 
    vupdate_lane_fp16(C125, A1, B3, 1); 
    vupdate_lane_fp16(C126, A1, B3, 2); 
    vupdate_lane_fp16(C127, A1, B3, 3); 
    vupdate_lane_fp16(C128, A1, B3, 4); 
    vupdate_lane_fp16(C129, A1, B3, 5); 
    vupdate_lane_fp16(C130, A1, B3, 6); 
    vupdate_lane_fp16(C131, A1, B3, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C216, A2, B2, 0); 
    vupdate_lane_fp16(C217, A2, B2, 1); 
    vupdate_lane_fp16(C218, A2, B2, 2); 
    vupdate_lane_fp16(C219, A2, B2, 3); 
    vupdate_lane_fp16(C220, A2, B2, 4); 
    vupdate_lane_fp16(C221, A2, B2, 5); 
    vupdate_lane_fp16(C222, A2, B2, 6); 
    vupdate_lane_fp16(C223, A2, B2, 7); 
    vupdate_lane_fp16(C224, A2, B3, 0); 
    vupdate_lane_fp16(C225, A2, B3, 1); 
    vupdate_lane_fp16(C226, A2, B3, 2); 
    vupdate_lane_fp16(C227, A2, B3, 3); 
    vupdate_lane_fp16(C228, A2, B3, 4); 
    vupdate_lane_fp16(C229, A2, B3, 5); 
    vupdate_lane_fp16(C230, A2, B3, 6); 
    vupdate_lane_fp16(C231, A2, B3, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    vupdate_lane_fp16(C38, A3, B1, 0); 
    vupdate_lane_fp16(C39, A3, B1, 1); 
    vupdate_lane_fp16(C310, A3, B1, 2); 
    vupdate_lane_fp16(C311, A3, B1, 3); 
    vupdate_lane_fp16(C312, A3, B1, 4); 
    vupdate_lane_fp16(C313, A3, B1, 5); 
    vupdate_lane_fp16(C314, A3, B1, 6); 
    vupdate_lane_fp16(C315, A3, B1, 7); 
    vupdate_lane_fp16(C316, A3, B2, 0); 
    vupdate_lane_fp16(C317, A3, B2, 1); 
    vupdate_lane_fp16(C318, A3, B2, 2); 
    vupdate_lane_fp16(C319, A3, B2, 3); 
    vupdate_lane_fp16(C320, A3, B2, 4); 
    vupdate_lane_fp16(C321, A3, B2, 5); 
    vupdate_lane_fp16(C322, A3, B2, 6); 
    vupdate_lane_fp16(C323, A3, B2, 7); 
    vupdate_lane_fp16(C324, A3, B3, 0); 
    vupdate_lane_fp16(C325, A3, B3, 1); 
    vupdate_lane_fp16(C326, A3, B3, 2); 
    vupdate_lane_fp16(C327, A3, B3, 3); 
    vupdate_lane_fp16(C328, A3, B3, 4); 
    vupdate_lane_fp16(C329, A3, B3, 5); 
    vupdate_lane_fp16(C330, A3, B3, 6); 
    vupdate_lane_fp16(C331, A3, B3, 7); 
    bA+=32;
    bB+=32;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(8,24), C124); 
  vstoreC_fp16(&Crref(8,25), C125); 
  vstoreC_fp16(&Crref(8,26), C126); 
  vstoreC_fp16(&Crref(8,27), C127); 
  vstoreC_fp16(&Crref(8,28), C128); 
  vstoreC_fp16(&Crref(8,29), C129); 
  vstoreC_fp16(&Crref(8,30), C130); 
  vstoreC_fp16(&Crref(8,31), C131); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(16,16), C216); 
  vstoreC_fp16(&Crref(16,17), C217); 
  vstoreC_fp16(&Crref(16,18), C218); 
  vstoreC_fp16(&Crref(16,19), C219); 
  vstoreC_fp16(&Crref(16,20), C220); 
  vstoreC_fp16(&Crref(16,21), C221); 
  vstoreC_fp16(&Crref(16,22), C222); 
  vstoreC_fp16(&Crref(16,23), C223); 
  vstoreC_fp16(&Crref(16,24), C224); 
  vstoreC_fp16(&Crref(16,25), C225); 
  vstoreC_fp16(&Crref(16,26), C226); 
  vstoreC_fp16(&Crref(16,27), C227); 
  vstoreC_fp16(&Crref(16,28), C228); 
  vstoreC_fp16(&Crref(16,29), C229); 
  vstoreC_fp16(&Crref(16,30), C230); 
  vstoreC_fp16(&Crref(16,31), C231); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
  vstoreC_fp16(&Crref(24,8), C38); 
  vstoreC_fp16(&Crref(24,9), C39); 
  vstoreC_fp16(&Crref(24,10), C310); 
  vstoreC_fp16(&Crref(24,11), C311); 
  vstoreC_fp16(&Crref(24,12), C312); 
  vstoreC_fp16(&Crref(24,13), C313); 
  vstoreC_fp16(&Crref(24,14), C314); 
  vstoreC_fp16(&Crref(24,15), C315); 
  vstoreC_fp16(&Crref(24,16), C316); 
  vstoreC_fp16(&Crref(24,17), C317); 
  vstoreC_fp16(&Crref(24,18), C318); 
  vstoreC_fp16(&Crref(24,19), C319); 
  vstoreC_fp16(&Crref(24,20), C320); 
  vstoreC_fp16(&Crref(24,21), C321); 
  vstoreC_fp16(&Crref(24,22), C322); 
  vstoreC_fp16(&Crref(24,23), C323); 
  vstoreC_fp16(&Crref(24,24), C324); 
  vstoreC_fp16(&Crref(24,25), C325); 
  vstoreC_fp16(&Crref(24,26), C326); 
  vstoreC_fp16(&Crref(24,27), C327); 
  vstoreC_fp16(&Crref(24,28), C328); 
  vstoreC_fp16(&Crref(24,29), C329); 
  vstoreC_fp16(&Crref(24,30), C330); 
  vstoreC_fp16(&Crref(24,31), C331); 
}
void ukernel_intrinsic_32x40_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  B0,  B1,  B2,  B3,  B4;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031,  C032,  C033,  C034,  C035,  C036,  C037,  C038,  C039,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C124,  C125,  C126,  C127,  C128,  C129,  C130,  C131,  C132,  C133,  C134,  C135,  C136,  C137,  C138,  C139,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C216,  C217,  C218,  C219,  C220,  C221,  C222,  C223,  C224,  C225,  C226,  C227,  C228,  C229,  C230,  C231,  C232,  C233,  C234,  C235,  C236,  C237,  C238,  C239,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37,  C38,  C39,  C310,  C311,  C312,  C313,  C314,  C315,  C316,  C317,  C318,  C319,  C320,  C321,  C322,  C323,  C324,  C325,  C326,  C327,  C328,  C329,  C330,  C331,  C332,  C333,  C334,  C335,  C336,  C337,  C338,  C339;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
    vinit_fp16(C032, 0);
    vinit_fp16(C033, 0);
    vinit_fp16(C034, 0);
    vinit_fp16(C035, 0);
    vinit_fp16(C036, 0);
    vinit_fp16(C037, 0);
    vinit_fp16(C038, 0);
    vinit_fp16(C039, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C124, 0);
    vinit_fp16(C125, 0);
    vinit_fp16(C126, 0);
    vinit_fp16(C127, 0);
    vinit_fp16(C128, 0);
    vinit_fp16(C129, 0);
    vinit_fp16(C130, 0);
    vinit_fp16(C131, 0);
    vinit_fp16(C132, 0);
    vinit_fp16(C133, 0);
    vinit_fp16(C134, 0);
    vinit_fp16(C135, 0);
    vinit_fp16(C136, 0);
    vinit_fp16(C137, 0);
    vinit_fp16(C138, 0);
    vinit_fp16(C139, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C216, 0);
    vinit_fp16(C217, 0);
    vinit_fp16(C218, 0);
    vinit_fp16(C219, 0);
    vinit_fp16(C220, 0);
    vinit_fp16(C221, 0);
    vinit_fp16(C222, 0);
    vinit_fp16(C223, 0);
    vinit_fp16(C224, 0);
    vinit_fp16(C225, 0);
    vinit_fp16(C226, 0);
    vinit_fp16(C227, 0);
    vinit_fp16(C228, 0);
    vinit_fp16(C229, 0);
    vinit_fp16(C230, 0);
    vinit_fp16(C231, 0);
    vinit_fp16(C232, 0);
    vinit_fp16(C233, 0);
    vinit_fp16(C234, 0);
    vinit_fp16(C235, 0);
    vinit_fp16(C236, 0);
    vinit_fp16(C237, 0);
    vinit_fp16(C238, 0);
    vinit_fp16(C239, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
    vinit_fp16(C38, 0);
    vinit_fp16(C39, 0);
    vinit_fp16(C310, 0);
    vinit_fp16(C311, 0);
    vinit_fp16(C312, 0);
    vinit_fp16(C313, 0);
    vinit_fp16(C314, 0);
    vinit_fp16(C315, 0);
    vinit_fp16(C316, 0);
    vinit_fp16(C317, 0);
    vinit_fp16(C318, 0);
    vinit_fp16(C319, 0);
    vinit_fp16(C320, 0);
    vinit_fp16(C321, 0);
    vinit_fp16(C322, 0);
    vinit_fp16(C323, 0);
    vinit_fp16(C324, 0);
    vinit_fp16(C325, 0);
    vinit_fp16(C326, 0);
    vinit_fp16(C327, 0);
    vinit_fp16(C328, 0);
    vinit_fp16(C329, 0);
    vinit_fp16(C330, 0);
    vinit_fp16(C331, 0);
    vinit_fp16(C332, 0);
    vinit_fp16(C333, 0);
    vinit_fp16(C334, 0);
    vinit_fp16(C335, 0);
    vinit_fp16(C336, 0);
    vinit_fp16(C337, 0);
    vinit_fp16(C338, 0);
    vinit_fp16(C339, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
    vloadC_fp16(C032, &Crref(0, 32));
    vloadC_fp16(C033, &Crref(0, 33));
    vloadC_fp16(C034, &Crref(0, 34));
    vloadC_fp16(C035, &Crref(0, 35));
    vloadC_fp16(C036, &Crref(0, 36));
    vloadC_fp16(C037, &Crref(0, 37));
    vloadC_fp16(C038, &Crref(0, 38));
    vloadC_fp16(C039, &Crref(0, 39));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C124, &Crref(8, 24));
    vloadC_fp16(C125, &Crref(8, 25));
    vloadC_fp16(C126, &Crref(8, 26));
    vloadC_fp16(C127, &Crref(8, 27));
    vloadC_fp16(C128, &Crref(8, 28));
    vloadC_fp16(C129, &Crref(8, 29));
    vloadC_fp16(C130, &Crref(8, 30));
    vloadC_fp16(C131, &Crref(8, 31));
    vloadC_fp16(C132, &Crref(8, 32));
    vloadC_fp16(C133, &Crref(8, 33));
    vloadC_fp16(C134, &Crref(8, 34));
    vloadC_fp16(C135, &Crref(8, 35));
    vloadC_fp16(C136, &Crref(8, 36));
    vloadC_fp16(C137, &Crref(8, 37));
    vloadC_fp16(C138, &Crref(8, 38));
    vloadC_fp16(C139, &Crref(8, 39));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C216, &Crref(16, 16));
    vloadC_fp16(C217, &Crref(16, 17));
    vloadC_fp16(C218, &Crref(16, 18));
    vloadC_fp16(C219, &Crref(16, 19));
    vloadC_fp16(C220, &Crref(16, 20));
    vloadC_fp16(C221, &Crref(16, 21));
    vloadC_fp16(C222, &Crref(16, 22));
    vloadC_fp16(C223, &Crref(16, 23));
    vloadC_fp16(C224, &Crref(16, 24));
    vloadC_fp16(C225, &Crref(16, 25));
    vloadC_fp16(C226, &Crref(16, 26));
    vloadC_fp16(C227, &Crref(16, 27));
    vloadC_fp16(C228, &Crref(16, 28));
    vloadC_fp16(C229, &Crref(16, 29));
    vloadC_fp16(C230, &Crref(16, 30));
    vloadC_fp16(C231, &Crref(16, 31));
    vloadC_fp16(C232, &Crref(16, 32));
    vloadC_fp16(C233, &Crref(16, 33));
    vloadC_fp16(C234, &Crref(16, 34));
    vloadC_fp16(C235, &Crref(16, 35));
    vloadC_fp16(C236, &Crref(16, 36));
    vloadC_fp16(C237, &Crref(16, 37));
    vloadC_fp16(C238, &Crref(16, 38));
    vloadC_fp16(C239, &Crref(16, 39));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
    vloadC_fp16(C38, &Crref(24, 8));
    vloadC_fp16(C39, &Crref(24, 9));
    vloadC_fp16(C310, &Crref(24, 10));
    vloadC_fp16(C311, &Crref(24, 11));
    vloadC_fp16(C312, &Crref(24, 12));
    vloadC_fp16(C313, &Crref(24, 13));
    vloadC_fp16(C314, &Crref(24, 14));
    vloadC_fp16(C315, &Crref(24, 15));
    vloadC_fp16(C316, &Crref(24, 16));
    vloadC_fp16(C317, &Crref(24, 17));
    vloadC_fp16(C318, &Crref(24, 18));
    vloadC_fp16(C319, &Crref(24, 19));
    vloadC_fp16(C320, &Crref(24, 20));
    vloadC_fp16(C321, &Crref(24, 21));
    vloadC_fp16(C322, &Crref(24, 22));
    vloadC_fp16(C323, &Crref(24, 23));
    vloadC_fp16(C324, &Crref(24, 24));
    vloadC_fp16(C325, &Crref(24, 25));
    vloadC_fp16(C326, &Crref(24, 26));
    vloadC_fp16(C327, &Crref(24, 27));
    vloadC_fp16(C328, &Crref(24, 28));
    vloadC_fp16(C329, &Crref(24, 29));
    vloadC_fp16(C330, &Crref(24, 30));
    vloadC_fp16(C331, &Crref(24, 31));
    vloadC_fp16(C332, &Crref(24, 32));
    vloadC_fp16(C333, &Crref(24, 33));
    vloadC_fp16(C334, &Crref(24, 34));
    vloadC_fp16(C335, &Crref(24, 35));
    vloadC_fp16(C336, &Crref(24, 36));
    vloadC_fp16(C337, &Crref(24, 37));
    vloadC_fp16(C338, &Crref(24, 38));
    vloadC_fp16(C339, &Crref(24, 39));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vload_fp16(B4, &Br[bB + 32]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    vupdate_lane_fp16(C032, A0, B4, 0); 
    vupdate_lane_fp16(C033, A0, B4, 1); 
    vupdate_lane_fp16(C034, A0, B4, 2); 
    vupdate_lane_fp16(C035, A0, B4, 3); 
    vupdate_lane_fp16(C036, A0, B4, 4); 
    vupdate_lane_fp16(C037, A0, B4, 5); 
    vupdate_lane_fp16(C038, A0, B4, 6); 
    vupdate_lane_fp16(C039, A0, B4, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C124, A1, B3, 0); 
    vupdate_lane_fp16(C125, A1, B3, 1); 
    vupdate_lane_fp16(C126, A1, B3, 2); 
    vupdate_lane_fp16(C127, A1, B3, 3); 
    vupdate_lane_fp16(C128, A1, B3, 4); 
    vupdate_lane_fp16(C129, A1, B3, 5); 
    vupdate_lane_fp16(C130, A1, B3, 6); 
    vupdate_lane_fp16(C131, A1, B3, 7); 
    vupdate_lane_fp16(C132, A1, B4, 0); 
    vupdate_lane_fp16(C133, A1, B4, 1); 
    vupdate_lane_fp16(C134, A1, B4, 2); 
    vupdate_lane_fp16(C135, A1, B4, 3); 
    vupdate_lane_fp16(C136, A1, B4, 4); 
    vupdate_lane_fp16(C137, A1, B4, 5); 
    vupdate_lane_fp16(C138, A1, B4, 6); 
    vupdate_lane_fp16(C139, A1, B4, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C216, A2, B2, 0); 
    vupdate_lane_fp16(C217, A2, B2, 1); 
    vupdate_lane_fp16(C218, A2, B2, 2); 
    vupdate_lane_fp16(C219, A2, B2, 3); 
    vupdate_lane_fp16(C220, A2, B2, 4); 
    vupdate_lane_fp16(C221, A2, B2, 5); 
    vupdate_lane_fp16(C222, A2, B2, 6); 
    vupdate_lane_fp16(C223, A2, B2, 7); 
    vupdate_lane_fp16(C224, A2, B3, 0); 
    vupdate_lane_fp16(C225, A2, B3, 1); 
    vupdate_lane_fp16(C226, A2, B3, 2); 
    vupdate_lane_fp16(C227, A2, B3, 3); 
    vupdate_lane_fp16(C228, A2, B3, 4); 
    vupdate_lane_fp16(C229, A2, B3, 5); 
    vupdate_lane_fp16(C230, A2, B3, 6); 
    vupdate_lane_fp16(C231, A2, B3, 7); 
    vupdate_lane_fp16(C232, A2, B4, 0); 
    vupdate_lane_fp16(C233, A2, B4, 1); 
    vupdate_lane_fp16(C234, A2, B4, 2); 
    vupdate_lane_fp16(C235, A2, B4, 3); 
    vupdate_lane_fp16(C236, A2, B4, 4); 
    vupdate_lane_fp16(C237, A2, B4, 5); 
    vupdate_lane_fp16(C238, A2, B4, 6); 
    vupdate_lane_fp16(C239, A2, B4, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    vupdate_lane_fp16(C38, A3, B1, 0); 
    vupdate_lane_fp16(C39, A3, B1, 1); 
    vupdate_lane_fp16(C310, A3, B1, 2); 
    vupdate_lane_fp16(C311, A3, B1, 3); 
    vupdate_lane_fp16(C312, A3, B1, 4); 
    vupdate_lane_fp16(C313, A3, B1, 5); 
    vupdate_lane_fp16(C314, A3, B1, 6); 
    vupdate_lane_fp16(C315, A3, B1, 7); 
    vupdate_lane_fp16(C316, A3, B2, 0); 
    vupdate_lane_fp16(C317, A3, B2, 1); 
    vupdate_lane_fp16(C318, A3, B2, 2); 
    vupdate_lane_fp16(C319, A3, B2, 3); 
    vupdate_lane_fp16(C320, A3, B2, 4); 
    vupdate_lane_fp16(C321, A3, B2, 5); 
    vupdate_lane_fp16(C322, A3, B2, 6); 
    vupdate_lane_fp16(C323, A3, B2, 7); 
    vupdate_lane_fp16(C324, A3, B3, 0); 
    vupdate_lane_fp16(C325, A3, B3, 1); 
    vupdate_lane_fp16(C326, A3, B3, 2); 
    vupdate_lane_fp16(C327, A3, B3, 3); 
    vupdate_lane_fp16(C328, A3, B3, 4); 
    vupdate_lane_fp16(C329, A3, B3, 5); 
    vupdate_lane_fp16(C330, A3, B3, 6); 
    vupdate_lane_fp16(C331, A3, B3, 7); 
    vupdate_lane_fp16(C332, A3, B4, 0); 
    vupdate_lane_fp16(C333, A3, B4, 1); 
    vupdate_lane_fp16(C334, A3, B4, 2); 
    vupdate_lane_fp16(C335, A3, B4, 3); 
    vupdate_lane_fp16(C336, A3, B4, 4); 
    vupdate_lane_fp16(C337, A3, B4, 5); 
    vupdate_lane_fp16(C338, A3, B4, 6); 
    vupdate_lane_fp16(C339, A3, B4, 7); 
    bA+=32;
    bB+=40;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
  vstoreC_fp16(&Crref(0,32), C032); 
  vstoreC_fp16(&Crref(0,33), C033); 
  vstoreC_fp16(&Crref(0,34), C034); 
  vstoreC_fp16(&Crref(0,35), C035); 
  vstoreC_fp16(&Crref(0,36), C036); 
  vstoreC_fp16(&Crref(0,37), C037); 
  vstoreC_fp16(&Crref(0,38), C038); 
  vstoreC_fp16(&Crref(0,39), C039); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(8,24), C124); 
  vstoreC_fp16(&Crref(8,25), C125); 
  vstoreC_fp16(&Crref(8,26), C126); 
  vstoreC_fp16(&Crref(8,27), C127); 
  vstoreC_fp16(&Crref(8,28), C128); 
  vstoreC_fp16(&Crref(8,29), C129); 
  vstoreC_fp16(&Crref(8,30), C130); 
  vstoreC_fp16(&Crref(8,31), C131); 
  vstoreC_fp16(&Crref(8,32), C132); 
  vstoreC_fp16(&Crref(8,33), C133); 
  vstoreC_fp16(&Crref(8,34), C134); 
  vstoreC_fp16(&Crref(8,35), C135); 
  vstoreC_fp16(&Crref(8,36), C136); 
  vstoreC_fp16(&Crref(8,37), C137); 
  vstoreC_fp16(&Crref(8,38), C138); 
  vstoreC_fp16(&Crref(8,39), C139); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(16,16), C216); 
  vstoreC_fp16(&Crref(16,17), C217); 
  vstoreC_fp16(&Crref(16,18), C218); 
  vstoreC_fp16(&Crref(16,19), C219); 
  vstoreC_fp16(&Crref(16,20), C220); 
  vstoreC_fp16(&Crref(16,21), C221); 
  vstoreC_fp16(&Crref(16,22), C222); 
  vstoreC_fp16(&Crref(16,23), C223); 
  vstoreC_fp16(&Crref(16,24), C224); 
  vstoreC_fp16(&Crref(16,25), C225); 
  vstoreC_fp16(&Crref(16,26), C226); 
  vstoreC_fp16(&Crref(16,27), C227); 
  vstoreC_fp16(&Crref(16,28), C228); 
  vstoreC_fp16(&Crref(16,29), C229); 
  vstoreC_fp16(&Crref(16,30), C230); 
  vstoreC_fp16(&Crref(16,31), C231); 
  vstoreC_fp16(&Crref(16,32), C232); 
  vstoreC_fp16(&Crref(16,33), C233); 
  vstoreC_fp16(&Crref(16,34), C234); 
  vstoreC_fp16(&Crref(16,35), C235); 
  vstoreC_fp16(&Crref(16,36), C236); 
  vstoreC_fp16(&Crref(16,37), C237); 
  vstoreC_fp16(&Crref(16,38), C238); 
  vstoreC_fp16(&Crref(16,39), C239); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
  vstoreC_fp16(&Crref(24,8), C38); 
  vstoreC_fp16(&Crref(24,9), C39); 
  vstoreC_fp16(&Crref(24,10), C310); 
  vstoreC_fp16(&Crref(24,11), C311); 
  vstoreC_fp16(&Crref(24,12), C312); 
  vstoreC_fp16(&Crref(24,13), C313); 
  vstoreC_fp16(&Crref(24,14), C314); 
  vstoreC_fp16(&Crref(24,15), C315); 
  vstoreC_fp16(&Crref(24,16), C316); 
  vstoreC_fp16(&Crref(24,17), C317); 
  vstoreC_fp16(&Crref(24,18), C318); 
  vstoreC_fp16(&Crref(24,19), C319); 
  vstoreC_fp16(&Crref(24,20), C320); 
  vstoreC_fp16(&Crref(24,21), C321); 
  vstoreC_fp16(&Crref(24,22), C322); 
  vstoreC_fp16(&Crref(24,23), C323); 
  vstoreC_fp16(&Crref(24,24), C324); 
  vstoreC_fp16(&Crref(24,25), C325); 
  vstoreC_fp16(&Crref(24,26), C326); 
  vstoreC_fp16(&Crref(24,27), C327); 
  vstoreC_fp16(&Crref(24,28), C328); 
  vstoreC_fp16(&Crref(24,29), C329); 
  vstoreC_fp16(&Crref(24,30), C330); 
  vstoreC_fp16(&Crref(24,31), C331); 
  vstoreC_fp16(&Crref(24,32), C332); 
  vstoreC_fp16(&Crref(24,33), C333); 
  vstoreC_fp16(&Crref(24,34), C334); 
  vstoreC_fp16(&Crref(24,35), C335); 
  vstoreC_fp16(&Crref(24,36), C336); 
  vstoreC_fp16(&Crref(24,37), C337); 
  vstoreC_fp16(&Crref(24,38), C338); 
  vstoreC_fp16(&Crref(24,39), C339); 
}
void ukernel_intrinsic_40x8_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  A4,  B0;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37,  C40,  C41,  C42,  C43,  C44,  C45,  C46,  C47;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
    vinit_fp16(C40, 0);
    vinit_fp16(C41, 0);
    vinit_fp16(C42, 0);
    vinit_fp16(C43, 0);
    vinit_fp16(C44, 0);
    vinit_fp16(C45, 0);
    vinit_fp16(C46, 0);
    vinit_fp16(C47, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
    vloadC_fp16(C40, &Crref(32, 0));
    vloadC_fp16(C41, &Crref(32, 1));
    vloadC_fp16(C42, &Crref(32, 2));
    vloadC_fp16(C43, &Crref(32, 3));
    vloadC_fp16(C44, &Crref(32, 4));
    vloadC_fp16(C45, &Crref(32, 5));
    vloadC_fp16(C46, &Crref(32, 6));
    vloadC_fp16(C47, &Crref(32, 7));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(A4, &Ar[bA + 32]);
    vload_fp16(B0, &Br[bB + 0]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    vupdate_lane_fp16(C40, A4, B0, 0); 
    vupdate_lane_fp16(C41, A4, B0, 1); 
    vupdate_lane_fp16(C42, A4, B0, 2); 
    vupdate_lane_fp16(C43, A4, B0, 3); 
    vupdate_lane_fp16(C44, A4, B0, 4); 
    vupdate_lane_fp16(C45, A4, B0, 5); 
    vupdate_lane_fp16(C46, A4, B0, 6); 
    vupdate_lane_fp16(C47, A4, B0, 7); 
    bA+=40;
    bB+=8;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
  vstoreC_fp16(&Crref(32,0), C40); 
  vstoreC_fp16(&Crref(32,1), C41); 
  vstoreC_fp16(&Crref(32,2), C42); 
  vstoreC_fp16(&Crref(32,3), C43); 
  vstoreC_fp16(&Crref(32,4), C44); 
  vstoreC_fp16(&Crref(32,5), C45); 
  vstoreC_fp16(&Crref(32,6), C46); 
  vstoreC_fp16(&Crref(32,7), C47); 
}
void ukernel_intrinsic_40x16_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  A4,  B0,  B1;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37,  C38,  C39,  C310,  C311,  C312,  C313,  C314,  C315,  C40,  C41,  C42,  C43,  C44,  C45,  C46,  C47,  C48,  C49,  C410,  C411,  C412,  C413,  C414,  C415;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
    vinit_fp16(C38, 0);
    vinit_fp16(C39, 0);
    vinit_fp16(C310, 0);
    vinit_fp16(C311, 0);
    vinit_fp16(C312, 0);
    vinit_fp16(C313, 0);
    vinit_fp16(C314, 0);
    vinit_fp16(C315, 0);
    vinit_fp16(C40, 0);
    vinit_fp16(C41, 0);
    vinit_fp16(C42, 0);
    vinit_fp16(C43, 0);
    vinit_fp16(C44, 0);
    vinit_fp16(C45, 0);
    vinit_fp16(C46, 0);
    vinit_fp16(C47, 0);
    vinit_fp16(C48, 0);
    vinit_fp16(C49, 0);
    vinit_fp16(C410, 0);
    vinit_fp16(C411, 0);
    vinit_fp16(C412, 0);
    vinit_fp16(C413, 0);
    vinit_fp16(C414, 0);
    vinit_fp16(C415, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
    vloadC_fp16(C38, &Crref(24, 8));
    vloadC_fp16(C39, &Crref(24, 9));
    vloadC_fp16(C310, &Crref(24, 10));
    vloadC_fp16(C311, &Crref(24, 11));
    vloadC_fp16(C312, &Crref(24, 12));
    vloadC_fp16(C313, &Crref(24, 13));
    vloadC_fp16(C314, &Crref(24, 14));
    vloadC_fp16(C315, &Crref(24, 15));
    vloadC_fp16(C40, &Crref(32, 0));
    vloadC_fp16(C41, &Crref(32, 1));
    vloadC_fp16(C42, &Crref(32, 2));
    vloadC_fp16(C43, &Crref(32, 3));
    vloadC_fp16(C44, &Crref(32, 4));
    vloadC_fp16(C45, &Crref(32, 5));
    vloadC_fp16(C46, &Crref(32, 6));
    vloadC_fp16(C47, &Crref(32, 7));
    vloadC_fp16(C48, &Crref(32, 8));
    vloadC_fp16(C49, &Crref(32, 9));
    vloadC_fp16(C410, &Crref(32, 10));
    vloadC_fp16(C411, &Crref(32, 11));
    vloadC_fp16(C412, &Crref(32, 12));
    vloadC_fp16(C413, &Crref(32, 13));
    vloadC_fp16(C414, &Crref(32, 14));
    vloadC_fp16(C415, &Crref(32, 15));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(A4, &Ar[bA + 32]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    vupdate_lane_fp16(C38, A3, B1, 0); 
    vupdate_lane_fp16(C39, A3, B1, 1); 
    vupdate_lane_fp16(C310, A3, B1, 2); 
    vupdate_lane_fp16(C311, A3, B1, 3); 
    vupdate_lane_fp16(C312, A3, B1, 4); 
    vupdate_lane_fp16(C313, A3, B1, 5); 
    vupdate_lane_fp16(C314, A3, B1, 6); 
    vupdate_lane_fp16(C315, A3, B1, 7); 
    vupdate_lane_fp16(C40, A4, B0, 0); 
    vupdate_lane_fp16(C41, A4, B0, 1); 
    vupdate_lane_fp16(C42, A4, B0, 2); 
    vupdate_lane_fp16(C43, A4, B0, 3); 
    vupdate_lane_fp16(C44, A4, B0, 4); 
    vupdate_lane_fp16(C45, A4, B0, 5); 
    vupdate_lane_fp16(C46, A4, B0, 6); 
    vupdate_lane_fp16(C47, A4, B0, 7); 
    vupdate_lane_fp16(C48, A4, B1, 0); 
    vupdate_lane_fp16(C49, A4, B1, 1); 
    vupdate_lane_fp16(C410, A4, B1, 2); 
    vupdate_lane_fp16(C411, A4, B1, 3); 
    vupdate_lane_fp16(C412, A4, B1, 4); 
    vupdate_lane_fp16(C413, A4, B1, 5); 
    vupdate_lane_fp16(C414, A4, B1, 6); 
    vupdate_lane_fp16(C415, A4, B1, 7); 
    bA+=40;
    bB+=16;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
  vstoreC_fp16(&Crref(24,8), C38); 
  vstoreC_fp16(&Crref(24,9), C39); 
  vstoreC_fp16(&Crref(24,10), C310); 
  vstoreC_fp16(&Crref(24,11), C311); 
  vstoreC_fp16(&Crref(24,12), C312); 
  vstoreC_fp16(&Crref(24,13), C313); 
  vstoreC_fp16(&Crref(24,14), C314); 
  vstoreC_fp16(&Crref(24,15), C315); 
  vstoreC_fp16(&Crref(32,0), C40); 
  vstoreC_fp16(&Crref(32,1), C41); 
  vstoreC_fp16(&Crref(32,2), C42); 
  vstoreC_fp16(&Crref(32,3), C43); 
  vstoreC_fp16(&Crref(32,4), C44); 
  vstoreC_fp16(&Crref(32,5), C45); 
  vstoreC_fp16(&Crref(32,6), C46); 
  vstoreC_fp16(&Crref(32,7), C47); 
  vstoreC_fp16(&Crref(32,8), C48); 
  vstoreC_fp16(&Crref(32,9), C49); 
  vstoreC_fp16(&Crref(32,10), C410); 
  vstoreC_fp16(&Crref(32,11), C411); 
  vstoreC_fp16(&Crref(32,12), C412); 
  vstoreC_fp16(&Crref(32,13), C413); 
  vstoreC_fp16(&Crref(32,14), C414); 
  vstoreC_fp16(&Crref(32,15), C415); 
}
void ukernel_intrinsic_40x24_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  A4,  B0,  B1,  B2;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C216,  C217,  C218,  C219,  C220,  C221,  C222,  C223,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37,  C38,  C39,  C310,  C311,  C312,  C313,  C314,  C315,  C316,  C317,  C318,  C319,  C320,  C321,  C322,  C323,  C40,  C41,  C42,  C43,  C44,  C45,  C46,  C47,  C48,  C49,  C410,  C411,  C412,  C413,  C414,  C415,  C416,  C417,  C418,  C419,  C420,  C421,  C422,  C423;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C216, 0);
    vinit_fp16(C217, 0);
    vinit_fp16(C218, 0);
    vinit_fp16(C219, 0);
    vinit_fp16(C220, 0);
    vinit_fp16(C221, 0);
    vinit_fp16(C222, 0);
    vinit_fp16(C223, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
    vinit_fp16(C38, 0);
    vinit_fp16(C39, 0);
    vinit_fp16(C310, 0);
    vinit_fp16(C311, 0);
    vinit_fp16(C312, 0);
    vinit_fp16(C313, 0);
    vinit_fp16(C314, 0);
    vinit_fp16(C315, 0);
    vinit_fp16(C316, 0);
    vinit_fp16(C317, 0);
    vinit_fp16(C318, 0);
    vinit_fp16(C319, 0);
    vinit_fp16(C320, 0);
    vinit_fp16(C321, 0);
    vinit_fp16(C322, 0);
    vinit_fp16(C323, 0);
    vinit_fp16(C40, 0);
    vinit_fp16(C41, 0);
    vinit_fp16(C42, 0);
    vinit_fp16(C43, 0);
    vinit_fp16(C44, 0);
    vinit_fp16(C45, 0);
    vinit_fp16(C46, 0);
    vinit_fp16(C47, 0);
    vinit_fp16(C48, 0);
    vinit_fp16(C49, 0);
    vinit_fp16(C410, 0);
    vinit_fp16(C411, 0);
    vinit_fp16(C412, 0);
    vinit_fp16(C413, 0);
    vinit_fp16(C414, 0);
    vinit_fp16(C415, 0);
    vinit_fp16(C416, 0);
    vinit_fp16(C417, 0);
    vinit_fp16(C418, 0);
    vinit_fp16(C419, 0);
    vinit_fp16(C420, 0);
    vinit_fp16(C421, 0);
    vinit_fp16(C422, 0);
    vinit_fp16(C423, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C216, &Crref(16, 16));
    vloadC_fp16(C217, &Crref(16, 17));
    vloadC_fp16(C218, &Crref(16, 18));
    vloadC_fp16(C219, &Crref(16, 19));
    vloadC_fp16(C220, &Crref(16, 20));
    vloadC_fp16(C221, &Crref(16, 21));
    vloadC_fp16(C222, &Crref(16, 22));
    vloadC_fp16(C223, &Crref(16, 23));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
    vloadC_fp16(C38, &Crref(24, 8));
    vloadC_fp16(C39, &Crref(24, 9));
    vloadC_fp16(C310, &Crref(24, 10));
    vloadC_fp16(C311, &Crref(24, 11));
    vloadC_fp16(C312, &Crref(24, 12));
    vloadC_fp16(C313, &Crref(24, 13));
    vloadC_fp16(C314, &Crref(24, 14));
    vloadC_fp16(C315, &Crref(24, 15));
    vloadC_fp16(C316, &Crref(24, 16));
    vloadC_fp16(C317, &Crref(24, 17));
    vloadC_fp16(C318, &Crref(24, 18));
    vloadC_fp16(C319, &Crref(24, 19));
    vloadC_fp16(C320, &Crref(24, 20));
    vloadC_fp16(C321, &Crref(24, 21));
    vloadC_fp16(C322, &Crref(24, 22));
    vloadC_fp16(C323, &Crref(24, 23));
    vloadC_fp16(C40, &Crref(32, 0));
    vloadC_fp16(C41, &Crref(32, 1));
    vloadC_fp16(C42, &Crref(32, 2));
    vloadC_fp16(C43, &Crref(32, 3));
    vloadC_fp16(C44, &Crref(32, 4));
    vloadC_fp16(C45, &Crref(32, 5));
    vloadC_fp16(C46, &Crref(32, 6));
    vloadC_fp16(C47, &Crref(32, 7));
    vloadC_fp16(C48, &Crref(32, 8));
    vloadC_fp16(C49, &Crref(32, 9));
    vloadC_fp16(C410, &Crref(32, 10));
    vloadC_fp16(C411, &Crref(32, 11));
    vloadC_fp16(C412, &Crref(32, 12));
    vloadC_fp16(C413, &Crref(32, 13));
    vloadC_fp16(C414, &Crref(32, 14));
    vloadC_fp16(C415, &Crref(32, 15));
    vloadC_fp16(C416, &Crref(32, 16));
    vloadC_fp16(C417, &Crref(32, 17));
    vloadC_fp16(C418, &Crref(32, 18));
    vloadC_fp16(C419, &Crref(32, 19));
    vloadC_fp16(C420, &Crref(32, 20));
    vloadC_fp16(C421, &Crref(32, 21));
    vloadC_fp16(C422, &Crref(32, 22));
    vloadC_fp16(C423, &Crref(32, 23));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(A4, &Ar[bA + 32]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C216, A2, B2, 0); 
    vupdate_lane_fp16(C217, A2, B2, 1); 
    vupdate_lane_fp16(C218, A2, B2, 2); 
    vupdate_lane_fp16(C219, A2, B2, 3); 
    vupdate_lane_fp16(C220, A2, B2, 4); 
    vupdate_lane_fp16(C221, A2, B2, 5); 
    vupdate_lane_fp16(C222, A2, B2, 6); 
    vupdate_lane_fp16(C223, A2, B2, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    vupdate_lane_fp16(C38, A3, B1, 0); 
    vupdate_lane_fp16(C39, A3, B1, 1); 
    vupdate_lane_fp16(C310, A3, B1, 2); 
    vupdate_lane_fp16(C311, A3, B1, 3); 
    vupdate_lane_fp16(C312, A3, B1, 4); 
    vupdate_lane_fp16(C313, A3, B1, 5); 
    vupdate_lane_fp16(C314, A3, B1, 6); 
    vupdate_lane_fp16(C315, A3, B1, 7); 
    vupdate_lane_fp16(C316, A3, B2, 0); 
    vupdate_lane_fp16(C317, A3, B2, 1); 
    vupdate_lane_fp16(C318, A3, B2, 2); 
    vupdate_lane_fp16(C319, A3, B2, 3); 
    vupdate_lane_fp16(C320, A3, B2, 4); 
    vupdate_lane_fp16(C321, A3, B2, 5); 
    vupdate_lane_fp16(C322, A3, B2, 6); 
    vupdate_lane_fp16(C323, A3, B2, 7); 
    vupdate_lane_fp16(C40, A4, B0, 0); 
    vupdate_lane_fp16(C41, A4, B0, 1); 
    vupdate_lane_fp16(C42, A4, B0, 2); 
    vupdate_lane_fp16(C43, A4, B0, 3); 
    vupdate_lane_fp16(C44, A4, B0, 4); 
    vupdate_lane_fp16(C45, A4, B0, 5); 
    vupdate_lane_fp16(C46, A4, B0, 6); 
    vupdate_lane_fp16(C47, A4, B0, 7); 
    vupdate_lane_fp16(C48, A4, B1, 0); 
    vupdate_lane_fp16(C49, A4, B1, 1); 
    vupdate_lane_fp16(C410, A4, B1, 2); 
    vupdate_lane_fp16(C411, A4, B1, 3); 
    vupdate_lane_fp16(C412, A4, B1, 4); 
    vupdate_lane_fp16(C413, A4, B1, 5); 
    vupdate_lane_fp16(C414, A4, B1, 6); 
    vupdate_lane_fp16(C415, A4, B1, 7); 
    vupdate_lane_fp16(C416, A4, B2, 0); 
    vupdate_lane_fp16(C417, A4, B2, 1); 
    vupdate_lane_fp16(C418, A4, B2, 2); 
    vupdate_lane_fp16(C419, A4, B2, 3); 
    vupdate_lane_fp16(C420, A4, B2, 4); 
    vupdate_lane_fp16(C421, A4, B2, 5); 
    vupdate_lane_fp16(C422, A4, B2, 6); 
    vupdate_lane_fp16(C423, A4, B2, 7); 
    bA+=40;
    bB+=24;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(16,16), C216); 
  vstoreC_fp16(&Crref(16,17), C217); 
  vstoreC_fp16(&Crref(16,18), C218); 
  vstoreC_fp16(&Crref(16,19), C219); 
  vstoreC_fp16(&Crref(16,20), C220); 
  vstoreC_fp16(&Crref(16,21), C221); 
  vstoreC_fp16(&Crref(16,22), C222); 
  vstoreC_fp16(&Crref(16,23), C223); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
  vstoreC_fp16(&Crref(24,8), C38); 
  vstoreC_fp16(&Crref(24,9), C39); 
  vstoreC_fp16(&Crref(24,10), C310); 
  vstoreC_fp16(&Crref(24,11), C311); 
  vstoreC_fp16(&Crref(24,12), C312); 
  vstoreC_fp16(&Crref(24,13), C313); 
  vstoreC_fp16(&Crref(24,14), C314); 
  vstoreC_fp16(&Crref(24,15), C315); 
  vstoreC_fp16(&Crref(24,16), C316); 
  vstoreC_fp16(&Crref(24,17), C317); 
  vstoreC_fp16(&Crref(24,18), C318); 
  vstoreC_fp16(&Crref(24,19), C319); 
  vstoreC_fp16(&Crref(24,20), C320); 
  vstoreC_fp16(&Crref(24,21), C321); 
  vstoreC_fp16(&Crref(24,22), C322); 
  vstoreC_fp16(&Crref(24,23), C323); 
  vstoreC_fp16(&Crref(32,0), C40); 
  vstoreC_fp16(&Crref(32,1), C41); 
  vstoreC_fp16(&Crref(32,2), C42); 
  vstoreC_fp16(&Crref(32,3), C43); 
  vstoreC_fp16(&Crref(32,4), C44); 
  vstoreC_fp16(&Crref(32,5), C45); 
  vstoreC_fp16(&Crref(32,6), C46); 
  vstoreC_fp16(&Crref(32,7), C47); 
  vstoreC_fp16(&Crref(32,8), C48); 
  vstoreC_fp16(&Crref(32,9), C49); 
  vstoreC_fp16(&Crref(32,10), C410); 
  vstoreC_fp16(&Crref(32,11), C411); 
  vstoreC_fp16(&Crref(32,12), C412); 
  vstoreC_fp16(&Crref(32,13), C413); 
  vstoreC_fp16(&Crref(32,14), C414); 
  vstoreC_fp16(&Crref(32,15), C415); 
  vstoreC_fp16(&Crref(32,16), C416); 
  vstoreC_fp16(&Crref(32,17), C417); 
  vstoreC_fp16(&Crref(32,18), C418); 
  vstoreC_fp16(&Crref(32,19), C419); 
  vstoreC_fp16(&Crref(32,20), C420); 
  vstoreC_fp16(&Crref(32,21), C421); 
  vstoreC_fp16(&Crref(32,22), C422); 
  vstoreC_fp16(&Crref(32,23), C423); 
}
void ukernel_intrinsic_40x32_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  A4,  B0,  B1,  B2,  B3;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C124,  C125,  C126,  C127,  C128,  C129,  C130,  C131,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C216,  C217,  C218,  C219,  C220,  C221,  C222,  C223,  C224,  C225,  C226,  C227,  C228,  C229,  C230,  C231,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37,  C38,  C39,  C310,  C311,  C312,  C313,  C314,  C315,  C316,  C317,  C318,  C319,  C320,  C321,  C322,  C323,  C324,  C325,  C326,  C327,  C328,  C329,  C330,  C331,  C40,  C41,  C42,  C43,  C44,  C45,  C46,  C47,  C48,  C49,  C410,  C411,  C412,  C413,  C414,  C415,  C416,  C417,  C418,  C419,  C420,  C421,  C422,  C423,  C424,  C425,  C426,  C427,  C428,  C429,  C430,  C431;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C124, 0);
    vinit_fp16(C125, 0);
    vinit_fp16(C126, 0);
    vinit_fp16(C127, 0);
    vinit_fp16(C128, 0);
    vinit_fp16(C129, 0);
    vinit_fp16(C130, 0);
    vinit_fp16(C131, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C216, 0);
    vinit_fp16(C217, 0);
    vinit_fp16(C218, 0);
    vinit_fp16(C219, 0);
    vinit_fp16(C220, 0);
    vinit_fp16(C221, 0);
    vinit_fp16(C222, 0);
    vinit_fp16(C223, 0);
    vinit_fp16(C224, 0);
    vinit_fp16(C225, 0);
    vinit_fp16(C226, 0);
    vinit_fp16(C227, 0);
    vinit_fp16(C228, 0);
    vinit_fp16(C229, 0);
    vinit_fp16(C230, 0);
    vinit_fp16(C231, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
    vinit_fp16(C38, 0);
    vinit_fp16(C39, 0);
    vinit_fp16(C310, 0);
    vinit_fp16(C311, 0);
    vinit_fp16(C312, 0);
    vinit_fp16(C313, 0);
    vinit_fp16(C314, 0);
    vinit_fp16(C315, 0);
    vinit_fp16(C316, 0);
    vinit_fp16(C317, 0);
    vinit_fp16(C318, 0);
    vinit_fp16(C319, 0);
    vinit_fp16(C320, 0);
    vinit_fp16(C321, 0);
    vinit_fp16(C322, 0);
    vinit_fp16(C323, 0);
    vinit_fp16(C324, 0);
    vinit_fp16(C325, 0);
    vinit_fp16(C326, 0);
    vinit_fp16(C327, 0);
    vinit_fp16(C328, 0);
    vinit_fp16(C329, 0);
    vinit_fp16(C330, 0);
    vinit_fp16(C331, 0);
    vinit_fp16(C40, 0);
    vinit_fp16(C41, 0);
    vinit_fp16(C42, 0);
    vinit_fp16(C43, 0);
    vinit_fp16(C44, 0);
    vinit_fp16(C45, 0);
    vinit_fp16(C46, 0);
    vinit_fp16(C47, 0);
    vinit_fp16(C48, 0);
    vinit_fp16(C49, 0);
    vinit_fp16(C410, 0);
    vinit_fp16(C411, 0);
    vinit_fp16(C412, 0);
    vinit_fp16(C413, 0);
    vinit_fp16(C414, 0);
    vinit_fp16(C415, 0);
    vinit_fp16(C416, 0);
    vinit_fp16(C417, 0);
    vinit_fp16(C418, 0);
    vinit_fp16(C419, 0);
    vinit_fp16(C420, 0);
    vinit_fp16(C421, 0);
    vinit_fp16(C422, 0);
    vinit_fp16(C423, 0);
    vinit_fp16(C424, 0);
    vinit_fp16(C425, 0);
    vinit_fp16(C426, 0);
    vinit_fp16(C427, 0);
    vinit_fp16(C428, 0);
    vinit_fp16(C429, 0);
    vinit_fp16(C430, 0);
    vinit_fp16(C431, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C124, &Crref(8, 24));
    vloadC_fp16(C125, &Crref(8, 25));
    vloadC_fp16(C126, &Crref(8, 26));
    vloadC_fp16(C127, &Crref(8, 27));
    vloadC_fp16(C128, &Crref(8, 28));
    vloadC_fp16(C129, &Crref(8, 29));
    vloadC_fp16(C130, &Crref(8, 30));
    vloadC_fp16(C131, &Crref(8, 31));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C216, &Crref(16, 16));
    vloadC_fp16(C217, &Crref(16, 17));
    vloadC_fp16(C218, &Crref(16, 18));
    vloadC_fp16(C219, &Crref(16, 19));
    vloadC_fp16(C220, &Crref(16, 20));
    vloadC_fp16(C221, &Crref(16, 21));
    vloadC_fp16(C222, &Crref(16, 22));
    vloadC_fp16(C223, &Crref(16, 23));
    vloadC_fp16(C224, &Crref(16, 24));
    vloadC_fp16(C225, &Crref(16, 25));
    vloadC_fp16(C226, &Crref(16, 26));
    vloadC_fp16(C227, &Crref(16, 27));
    vloadC_fp16(C228, &Crref(16, 28));
    vloadC_fp16(C229, &Crref(16, 29));
    vloadC_fp16(C230, &Crref(16, 30));
    vloadC_fp16(C231, &Crref(16, 31));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
    vloadC_fp16(C38, &Crref(24, 8));
    vloadC_fp16(C39, &Crref(24, 9));
    vloadC_fp16(C310, &Crref(24, 10));
    vloadC_fp16(C311, &Crref(24, 11));
    vloadC_fp16(C312, &Crref(24, 12));
    vloadC_fp16(C313, &Crref(24, 13));
    vloadC_fp16(C314, &Crref(24, 14));
    vloadC_fp16(C315, &Crref(24, 15));
    vloadC_fp16(C316, &Crref(24, 16));
    vloadC_fp16(C317, &Crref(24, 17));
    vloadC_fp16(C318, &Crref(24, 18));
    vloadC_fp16(C319, &Crref(24, 19));
    vloadC_fp16(C320, &Crref(24, 20));
    vloadC_fp16(C321, &Crref(24, 21));
    vloadC_fp16(C322, &Crref(24, 22));
    vloadC_fp16(C323, &Crref(24, 23));
    vloadC_fp16(C324, &Crref(24, 24));
    vloadC_fp16(C325, &Crref(24, 25));
    vloadC_fp16(C326, &Crref(24, 26));
    vloadC_fp16(C327, &Crref(24, 27));
    vloadC_fp16(C328, &Crref(24, 28));
    vloadC_fp16(C329, &Crref(24, 29));
    vloadC_fp16(C330, &Crref(24, 30));
    vloadC_fp16(C331, &Crref(24, 31));
    vloadC_fp16(C40, &Crref(32, 0));
    vloadC_fp16(C41, &Crref(32, 1));
    vloadC_fp16(C42, &Crref(32, 2));
    vloadC_fp16(C43, &Crref(32, 3));
    vloadC_fp16(C44, &Crref(32, 4));
    vloadC_fp16(C45, &Crref(32, 5));
    vloadC_fp16(C46, &Crref(32, 6));
    vloadC_fp16(C47, &Crref(32, 7));
    vloadC_fp16(C48, &Crref(32, 8));
    vloadC_fp16(C49, &Crref(32, 9));
    vloadC_fp16(C410, &Crref(32, 10));
    vloadC_fp16(C411, &Crref(32, 11));
    vloadC_fp16(C412, &Crref(32, 12));
    vloadC_fp16(C413, &Crref(32, 13));
    vloadC_fp16(C414, &Crref(32, 14));
    vloadC_fp16(C415, &Crref(32, 15));
    vloadC_fp16(C416, &Crref(32, 16));
    vloadC_fp16(C417, &Crref(32, 17));
    vloadC_fp16(C418, &Crref(32, 18));
    vloadC_fp16(C419, &Crref(32, 19));
    vloadC_fp16(C420, &Crref(32, 20));
    vloadC_fp16(C421, &Crref(32, 21));
    vloadC_fp16(C422, &Crref(32, 22));
    vloadC_fp16(C423, &Crref(32, 23));
    vloadC_fp16(C424, &Crref(32, 24));
    vloadC_fp16(C425, &Crref(32, 25));
    vloadC_fp16(C426, &Crref(32, 26));
    vloadC_fp16(C427, &Crref(32, 27));
    vloadC_fp16(C428, &Crref(32, 28));
    vloadC_fp16(C429, &Crref(32, 29));
    vloadC_fp16(C430, &Crref(32, 30));
    vloadC_fp16(C431, &Crref(32, 31));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(A4, &Ar[bA + 32]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C124, A1, B3, 0); 
    vupdate_lane_fp16(C125, A1, B3, 1); 
    vupdate_lane_fp16(C126, A1, B3, 2); 
    vupdate_lane_fp16(C127, A1, B3, 3); 
    vupdate_lane_fp16(C128, A1, B3, 4); 
    vupdate_lane_fp16(C129, A1, B3, 5); 
    vupdate_lane_fp16(C130, A1, B3, 6); 
    vupdate_lane_fp16(C131, A1, B3, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C216, A2, B2, 0); 
    vupdate_lane_fp16(C217, A2, B2, 1); 
    vupdate_lane_fp16(C218, A2, B2, 2); 
    vupdate_lane_fp16(C219, A2, B2, 3); 
    vupdate_lane_fp16(C220, A2, B2, 4); 
    vupdate_lane_fp16(C221, A2, B2, 5); 
    vupdate_lane_fp16(C222, A2, B2, 6); 
    vupdate_lane_fp16(C223, A2, B2, 7); 
    vupdate_lane_fp16(C224, A2, B3, 0); 
    vupdate_lane_fp16(C225, A2, B3, 1); 
    vupdate_lane_fp16(C226, A2, B3, 2); 
    vupdate_lane_fp16(C227, A2, B3, 3); 
    vupdate_lane_fp16(C228, A2, B3, 4); 
    vupdate_lane_fp16(C229, A2, B3, 5); 
    vupdate_lane_fp16(C230, A2, B3, 6); 
    vupdate_lane_fp16(C231, A2, B3, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    vupdate_lane_fp16(C38, A3, B1, 0); 
    vupdate_lane_fp16(C39, A3, B1, 1); 
    vupdate_lane_fp16(C310, A3, B1, 2); 
    vupdate_lane_fp16(C311, A3, B1, 3); 
    vupdate_lane_fp16(C312, A3, B1, 4); 
    vupdate_lane_fp16(C313, A3, B1, 5); 
    vupdate_lane_fp16(C314, A3, B1, 6); 
    vupdate_lane_fp16(C315, A3, B1, 7); 
    vupdate_lane_fp16(C316, A3, B2, 0); 
    vupdate_lane_fp16(C317, A3, B2, 1); 
    vupdate_lane_fp16(C318, A3, B2, 2); 
    vupdate_lane_fp16(C319, A3, B2, 3); 
    vupdate_lane_fp16(C320, A3, B2, 4); 
    vupdate_lane_fp16(C321, A3, B2, 5); 
    vupdate_lane_fp16(C322, A3, B2, 6); 
    vupdate_lane_fp16(C323, A3, B2, 7); 
    vupdate_lane_fp16(C324, A3, B3, 0); 
    vupdate_lane_fp16(C325, A3, B3, 1); 
    vupdate_lane_fp16(C326, A3, B3, 2); 
    vupdate_lane_fp16(C327, A3, B3, 3); 
    vupdate_lane_fp16(C328, A3, B3, 4); 
    vupdate_lane_fp16(C329, A3, B3, 5); 
    vupdate_lane_fp16(C330, A3, B3, 6); 
    vupdate_lane_fp16(C331, A3, B3, 7); 
    vupdate_lane_fp16(C40, A4, B0, 0); 
    vupdate_lane_fp16(C41, A4, B0, 1); 
    vupdate_lane_fp16(C42, A4, B0, 2); 
    vupdate_lane_fp16(C43, A4, B0, 3); 
    vupdate_lane_fp16(C44, A4, B0, 4); 
    vupdate_lane_fp16(C45, A4, B0, 5); 
    vupdate_lane_fp16(C46, A4, B0, 6); 
    vupdate_lane_fp16(C47, A4, B0, 7); 
    vupdate_lane_fp16(C48, A4, B1, 0); 
    vupdate_lane_fp16(C49, A4, B1, 1); 
    vupdate_lane_fp16(C410, A4, B1, 2); 
    vupdate_lane_fp16(C411, A4, B1, 3); 
    vupdate_lane_fp16(C412, A4, B1, 4); 
    vupdate_lane_fp16(C413, A4, B1, 5); 
    vupdate_lane_fp16(C414, A4, B1, 6); 
    vupdate_lane_fp16(C415, A4, B1, 7); 
    vupdate_lane_fp16(C416, A4, B2, 0); 
    vupdate_lane_fp16(C417, A4, B2, 1); 
    vupdate_lane_fp16(C418, A4, B2, 2); 
    vupdate_lane_fp16(C419, A4, B2, 3); 
    vupdate_lane_fp16(C420, A4, B2, 4); 
    vupdate_lane_fp16(C421, A4, B2, 5); 
    vupdate_lane_fp16(C422, A4, B2, 6); 
    vupdate_lane_fp16(C423, A4, B2, 7); 
    vupdate_lane_fp16(C424, A4, B3, 0); 
    vupdate_lane_fp16(C425, A4, B3, 1); 
    vupdate_lane_fp16(C426, A4, B3, 2); 
    vupdate_lane_fp16(C427, A4, B3, 3); 
    vupdate_lane_fp16(C428, A4, B3, 4); 
    vupdate_lane_fp16(C429, A4, B3, 5); 
    vupdate_lane_fp16(C430, A4, B3, 6); 
    vupdate_lane_fp16(C431, A4, B3, 7); 
    bA+=40;
    bB+=32;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(8,24), C124); 
  vstoreC_fp16(&Crref(8,25), C125); 
  vstoreC_fp16(&Crref(8,26), C126); 
  vstoreC_fp16(&Crref(8,27), C127); 
  vstoreC_fp16(&Crref(8,28), C128); 
  vstoreC_fp16(&Crref(8,29), C129); 
  vstoreC_fp16(&Crref(8,30), C130); 
  vstoreC_fp16(&Crref(8,31), C131); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(16,16), C216); 
  vstoreC_fp16(&Crref(16,17), C217); 
  vstoreC_fp16(&Crref(16,18), C218); 
  vstoreC_fp16(&Crref(16,19), C219); 
  vstoreC_fp16(&Crref(16,20), C220); 
  vstoreC_fp16(&Crref(16,21), C221); 
  vstoreC_fp16(&Crref(16,22), C222); 
  vstoreC_fp16(&Crref(16,23), C223); 
  vstoreC_fp16(&Crref(16,24), C224); 
  vstoreC_fp16(&Crref(16,25), C225); 
  vstoreC_fp16(&Crref(16,26), C226); 
  vstoreC_fp16(&Crref(16,27), C227); 
  vstoreC_fp16(&Crref(16,28), C228); 
  vstoreC_fp16(&Crref(16,29), C229); 
  vstoreC_fp16(&Crref(16,30), C230); 
  vstoreC_fp16(&Crref(16,31), C231); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
  vstoreC_fp16(&Crref(24,8), C38); 
  vstoreC_fp16(&Crref(24,9), C39); 
  vstoreC_fp16(&Crref(24,10), C310); 
  vstoreC_fp16(&Crref(24,11), C311); 
  vstoreC_fp16(&Crref(24,12), C312); 
  vstoreC_fp16(&Crref(24,13), C313); 
  vstoreC_fp16(&Crref(24,14), C314); 
  vstoreC_fp16(&Crref(24,15), C315); 
  vstoreC_fp16(&Crref(24,16), C316); 
  vstoreC_fp16(&Crref(24,17), C317); 
  vstoreC_fp16(&Crref(24,18), C318); 
  vstoreC_fp16(&Crref(24,19), C319); 
  vstoreC_fp16(&Crref(24,20), C320); 
  vstoreC_fp16(&Crref(24,21), C321); 
  vstoreC_fp16(&Crref(24,22), C322); 
  vstoreC_fp16(&Crref(24,23), C323); 
  vstoreC_fp16(&Crref(24,24), C324); 
  vstoreC_fp16(&Crref(24,25), C325); 
  vstoreC_fp16(&Crref(24,26), C326); 
  vstoreC_fp16(&Crref(24,27), C327); 
  vstoreC_fp16(&Crref(24,28), C328); 
  vstoreC_fp16(&Crref(24,29), C329); 
  vstoreC_fp16(&Crref(24,30), C330); 
  vstoreC_fp16(&Crref(24,31), C331); 
  vstoreC_fp16(&Crref(32,0), C40); 
  vstoreC_fp16(&Crref(32,1), C41); 
  vstoreC_fp16(&Crref(32,2), C42); 
  vstoreC_fp16(&Crref(32,3), C43); 
  vstoreC_fp16(&Crref(32,4), C44); 
  vstoreC_fp16(&Crref(32,5), C45); 
  vstoreC_fp16(&Crref(32,6), C46); 
  vstoreC_fp16(&Crref(32,7), C47); 
  vstoreC_fp16(&Crref(32,8), C48); 
  vstoreC_fp16(&Crref(32,9), C49); 
  vstoreC_fp16(&Crref(32,10), C410); 
  vstoreC_fp16(&Crref(32,11), C411); 
  vstoreC_fp16(&Crref(32,12), C412); 
  vstoreC_fp16(&Crref(32,13), C413); 
  vstoreC_fp16(&Crref(32,14), C414); 
  vstoreC_fp16(&Crref(32,15), C415); 
  vstoreC_fp16(&Crref(32,16), C416); 
  vstoreC_fp16(&Crref(32,17), C417); 
  vstoreC_fp16(&Crref(32,18), C418); 
  vstoreC_fp16(&Crref(32,19), C419); 
  vstoreC_fp16(&Crref(32,20), C420); 
  vstoreC_fp16(&Crref(32,21), C421); 
  vstoreC_fp16(&Crref(32,22), C422); 
  vstoreC_fp16(&Crref(32,23), C423); 
  vstoreC_fp16(&Crref(32,24), C424); 
  vstoreC_fp16(&Crref(32,25), C425); 
  vstoreC_fp16(&Crref(32,26), C426); 
  vstoreC_fp16(&Crref(32,27), C427); 
  vstoreC_fp16(&Crref(32,28), C428); 
  vstoreC_fp16(&Crref(32,29), C429); 
  vstoreC_fp16(&Crref(32,30), C430); 
  vstoreC_fp16(&Crref(32,31), C431); 
}
void ukernel_intrinsic_40x40_fp16(int kc, float16_t *Ar, float16_t *Br, float16_t *Cr, float16_t beta, int Clda){
  int pr, bA = 0, bB = 0;
  float16x8_t  vtmp;
  float16x8_t  A0,  A1,  A2,  A3,  A4,  B0,  B1,  B2,  B3,  B4;
  float16x8_t  C00,  C01,  C02,  C03,  C04,  C05,  C06,  C07,  C08,  C09,  C010,  C011,  C012,  C013,  C014,  C015,  C016,  C017,  C018,  C019,  C020,  C021,  C022,  C023,  C024,  C025,  C026,  C027,  C028,  C029,  C030,  C031,  C032,  C033,  C034,  C035,  C036,  C037,  C038,  C039,  C10,  C11,  C12,  C13,  C14,  C15,  C16,  C17,  C18,  C19,  C110,  C111,  C112,  C113,  C114,  C115,  C116,  C117,  C118,  C119,  C120,  C121,  C122,  C123,  C124,  C125,  C126,  C127,  C128,  C129,  C130,  C131,  C132,  C133,  C134,  C135,  C136,  C137,  C138,  C139,  C20,  C21,  C22,  C23,  C24,  C25,  C26,  C27,  C28,  C29,  C210,  C211,  C212,  C213,  C214,  C215,  C216,  C217,  C218,  C219,  C220,  C221,  C222,  C223,  C224,  C225,  C226,  C227,  C228,  C229,  C230,  C231,  C232,  C233,  C234,  C235,  C236,  C237,  C238,  C239,  C30,  C31,  C32,  C33,  C34,  C35,  C36,  C37,  C38,  C39,  C310,  C311,  C312,  C313,  C314,  C315,  C316,  C317,  C318,  C319,  C320,  C321,  C322,  C323,  C324,  C325,  C326,  C327,  C328,  C329,  C330,  C331,  C332,  C333,  C334,  C335,  C336,  C337,  C338,  C339,  C40,  C41,  C42,  C43,  C44,  C45,  C46,  C47,  C48,  C49,  C410,  C411,  C412,  C413,  C414,  C415,  C416,  C417,  C418,  C419,  C420,  C421,  C422,  C423,  C424,  C425,  C426,  C427,  C428,  C429,  C430,  C431,  C432,  C433,  C434,  C435,  C436,  C437,  C438,  C439;

  if (beta == 0) {
    vinit_fp16(C00, 0);
    vinit_fp16(C01, 0);
    vinit_fp16(C02, 0);
    vinit_fp16(C03, 0);
    vinit_fp16(C04, 0);
    vinit_fp16(C05, 0);
    vinit_fp16(C06, 0);
    vinit_fp16(C07, 0);
    vinit_fp16(C08, 0);
    vinit_fp16(C09, 0);
    vinit_fp16(C010, 0);
    vinit_fp16(C011, 0);
    vinit_fp16(C012, 0);
    vinit_fp16(C013, 0);
    vinit_fp16(C014, 0);
    vinit_fp16(C015, 0);
    vinit_fp16(C016, 0);
    vinit_fp16(C017, 0);
    vinit_fp16(C018, 0);
    vinit_fp16(C019, 0);
    vinit_fp16(C020, 0);
    vinit_fp16(C021, 0);
    vinit_fp16(C022, 0);
    vinit_fp16(C023, 0);
    vinit_fp16(C024, 0);
    vinit_fp16(C025, 0);
    vinit_fp16(C026, 0);
    vinit_fp16(C027, 0);
    vinit_fp16(C028, 0);
    vinit_fp16(C029, 0);
    vinit_fp16(C030, 0);
    vinit_fp16(C031, 0);
    vinit_fp16(C032, 0);
    vinit_fp16(C033, 0);
    vinit_fp16(C034, 0);
    vinit_fp16(C035, 0);
    vinit_fp16(C036, 0);
    vinit_fp16(C037, 0);
    vinit_fp16(C038, 0);
    vinit_fp16(C039, 0);
    vinit_fp16(C10, 0);
    vinit_fp16(C11, 0);
    vinit_fp16(C12, 0);
    vinit_fp16(C13, 0);
    vinit_fp16(C14, 0);
    vinit_fp16(C15, 0);
    vinit_fp16(C16, 0);
    vinit_fp16(C17, 0);
    vinit_fp16(C18, 0);
    vinit_fp16(C19, 0);
    vinit_fp16(C110, 0);
    vinit_fp16(C111, 0);
    vinit_fp16(C112, 0);
    vinit_fp16(C113, 0);
    vinit_fp16(C114, 0);
    vinit_fp16(C115, 0);
    vinit_fp16(C116, 0);
    vinit_fp16(C117, 0);
    vinit_fp16(C118, 0);
    vinit_fp16(C119, 0);
    vinit_fp16(C120, 0);
    vinit_fp16(C121, 0);
    vinit_fp16(C122, 0);
    vinit_fp16(C123, 0);
    vinit_fp16(C124, 0);
    vinit_fp16(C125, 0);
    vinit_fp16(C126, 0);
    vinit_fp16(C127, 0);
    vinit_fp16(C128, 0);
    vinit_fp16(C129, 0);
    vinit_fp16(C130, 0);
    vinit_fp16(C131, 0);
    vinit_fp16(C132, 0);
    vinit_fp16(C133, 0);
    vinit_fp16(C134, 0);
    vinit_fp16(C135, 0);
    vinit_fp16(C136, 0);
    vinit_fp16(C137, 0);
    vinit_fp16(C138, 0);
    vinit_fp16(C139, 0);
    vinit_fp16(C20, 0);
    vinit_fp16(C21, 0);
    vinit_fp16(C22, 0);
    vinit_fp16(C23, 0);
    vinit_fp16(C24, 0);
    vinit_fp16(C25, 0);
    vinit_fp16(C26, 0);
    vinit_fp16(C27, 0);
    vinit_fp16(C28, 0);
    vinit_fp16(C29, 0);
    vinit_fp16(C210, 0);
    vinit_fp16(C211, 0);
    vinit_fp16(C212, 0);
    vinit_fp16(C213, 0);
    vinit_fp16(C214, 0);
    vinit_fp16(C215, 0);
    vinit_fp16(C216, 0);
    vinit_fp16(C217, 0);
    vinit_fp16(C218, 0);
    vinit_fp16(C219, 0);
    vinit_fp16(C220, 0);
    vinit_fp16(C221, 0);
    vinit_fp16(C222, 0);
    vinit_fp16(C223, 0);
    vinit_fp16(C224, 0);
    vinit_fp16(C225, 0);
    vinit_fp16(C226, 0);
    vinit_fp16(C227, 0);
    vinit_fp16(C228, 0);
    vinit_fp16(C229, 0);
    vinit_fp16(C230, 0);
    vinit_fp16(C231, 0);
    vinit_fp16(C232, 0);
    vinit_fp16(C233, 0);
    vinit_fp16(C234, 0);
    vinit_fp16(C235, 0);
    vinit_fp16(C236, 0);
    vinit_fp16(C237, 0);
    vinit_fp16(C238, 0);
    vinit_fp16(C239, 0);
    vinit_fp16(C30, 0);
    vinit_fp16(C31, 0);
    vinit_fp16(C32, 0);
    vinit_fp16(C33, 0);
    vinit_fp16(C34, 0);
    vinit_fp16(C35, 0);
    vinit_fp16(C36, 0);
    vinit_fp16(C37, 0);
    vinit_fp16(C38, 0);
    vinit_fp16(C39, 0);
    vinit_fp16(C310, 0);
    vinit_fp16(C311, 0);
    vinit_fp16(C312, 0);
    vinit_fp16(C313, 0);
    vinit_fp16(C314, 0);
    vinit_fp16(C315, 0);
    vinit_fp16(C316, 0);
    vinit_fp16(C317, 0);
    vinit_fp16(C318, 0);
    vinit_fp16(C319, 0);
    vinit_fp16(C320, 0);
    vinit_fp16(C321, 0);
    vinit_fp16(C322, 0);
    vinit_fp16(C323, 0);
    vinit_fp16(C324, 0);
    vinit_fp16(C325, 0);
    vinit_fp16(C326, 0);
    vinit_fp16(C327, 0);
    vinit_fp16(C328, 0);
    vinit_fp16(C329, 0);
    vinit_fp16(C330, 0);
    vinit_fp16(C331, 0);
    vinit_fp16(C332, 0);
    vinit_fp16(C333, 0);
    vinit_fp16(C334, 0);
    vinit_fp16(C335, 0);
    vinit_fp16(C336, 0);
    vinit_fp16(C337, 0);
    vinit_fp16(C338, 0);
    vinit_fp16(C339, 0);
    vinit_fp16(C40, 0);
    vinit_fp16(C41, 0);
    vinit_fp16(C42, 0);
    vinit_fp16(C43, 0);
    vinit_fp16(C44, 0);
    vinit_fp16(C45, 0);
    vinit_fp16(C46, 0);
    vinit_fp16(C47, 0);
    vinit_fp16(C48, 0);
    vinit_fp16(C49, 0);
    vinit_fp16(C410, 0);
    vinit_fp16(C411, 0);
    vinit_fp16(C412, 0);
    vinit_fp16(C413, 0);
    vinit_fp16(C414, 0);
    vinit_fp16(C415, 0);
    vinit_fp16(C416, 0);
    vinit_fp16(C417, 0);
    vinit_fp16(C418, 0);
    vinit_fp16(C419, 0);
    vinit_fp16(C420, 0);
    vinit_fp16(C421, 0);
    vinit_fp16(C422, 0);
    vinit_fp16(C423, 0);
    vinit_fp16(C424, 0);
    vinit_fp16(C425, 0);
    vinit_fp16(C426, 0);
    vinit_fp16(C427, 0);
    vinit_fp16(C428, 0);
    vinit_fp16(C429, 0);
    vinit_fp16(C430, 0);
    vinit_fp16(C431, 0);
    vinit_fp16(C432, 0);
    vinit_fp16(C433, 0);
    vinit_fp16(C434, 0);
    vinit_fp16(C435, 0);
    vinit_fp16(C436, 0);
    vinit_fp16(C437, 0);
    vinit_fp16(C438, 0);
    vinit_fp16(C439, 0);
  } else {
    vloadC_fp16(C00, &Crref(0, 0));
    vloadC_fp16(C01, &Crref(0, 1));
    vloadC_fp16(C02, &Crref(0, 2));
    vloadC_fp16(C03, &Crref(0, 3));
    vloadC_fp16(C04, &Crref(0, 4));
    vloadC_fp16(C05, &Crref(0, 5));
    vloadC_fp16(C06, &Crref(0, 6));
    vloadC_fp16(C07, &Crref(0, 7));
    vloadC_fp16(C08, &Crref(0, 8));
    vloadC_fp16(C09, &Crref(0, 9));
    vloadC_fp16(C010, &Crref(0, 10));
    vloadC_fp16(C011, &Crref(0, 11));
    vloadC_fp16(C012, &Crref(0, 12));
    vloadC_fp16(C013, &Crref(0, 13));
    vloadC_fp16(C014, &Crref(0, 14));
    vloadC_fp16(C015, &Crref(0, 15));
    vloadC_fp16(C016, &Crref(0, 16));
    vloadC_fp16(C017, &Crref(0, 17));
    vloadC_fp16(C018, &Crref(0, 18));
    vloadC_fp16(C019, &Crref(0, 19));
    vloadC_fp16(C020, &Crref(0, 20));
    vloadC_fp16(C021, &Crref(0, 21));
    vloadC_fp16(C022, &Crref(0, 22));
    vloadC_fp16(C023, &Crref(0, 23));
    vloadC_fp16(C024, &Crref(0, 24));
    vloadC_fp16(C025, &Crref(0, 25));
    vloadC_fp16(C026, &Crref(0, 26));
    vloadC_fp16(C027, &Crref(0, 27));
    vloadC_fp16(C028, &Crref(0, 28));
    vloadC_fp16(C029, &Crref(0, 29));
    vloadC_fp16(C030, &Crref(0, 30));
    vloadC_fp16(C031, &Crref(0, 31));
    vloadC_fp16(C032, &Crref(0, 32));
    vloadC_fp16(C033, &Crref(0, 33));
    vloadC_fp16(C034, &Crref(0, 34));
    vloadC_fp16(C035, &Crref(0, 35));
    vloadC_fp16(C036, &Crref(0, 36));
    vloadC_fp16(C037, &Crref(0, 37));
    vloadC_fp16(C038, &Crref(0, 38));
    vloadC_fp16(C039, &Crref(0, 39));
    vloadC_fp16(C10, &Crref(8, 0));
    vloadC_fp16(C11, &Crref(8, 1));
    vloadC_fp16(C12, &Crref(8, 2));
    vloadC_fp16(C13, &Crref(8, 3));
    vloadC_fp16(C14, &Crref(8, 4));
    vloadC_fp16(C15, &Crref(8, 5));
    vloadC_fp16(C16, &Crref(8, 6));
    vloadC_fp16(C17, &Crref(8, 7));
    vloadC_fp16(C18, &Crref(8, 8));
    vloadC_fp16(C19, &Crref(8, 9));
    vloadC_fp16(C110, &Crref(8, 10));
    vloadC_fp16(C111, &Crref(8, 11));
    vloadC_fp16(C112, &Crref(8, 12));
    vloadC_fp16(C113, &Crref(8, 13));
    vloadC_fp16(C114, &Crref(8, 14));
    vloadC_fp16(C115, &Crref(8, 15));
    vloadC_fp16(C116, &Crref(8, 16));
    vloadC_fp16(C117, &Crref(8, 17));
    vloadC_fp16(C118, &Crref(8, 18));
    vloadC_fp16(C119, &Crref(8, 19));
    vloadC_fp16(C120, &Crref(8, 20));
    vloadC_fp16(C121, &Crref(8, 21));
    vloadC_fp16(C122, &Crref(8, 22));
    vloadC_fp16(C123, &Crref(8, 23));
    vloadC_fp16(C124, &Crref(8, 24));
    vloadC_fp16(C125, &Crref(8, 25));
    vloadC_fp16(C126, &Crref(8, 26));
    vloadC_fp16(C127, &Crref(8, 27));
    vloadC_fp16(C128, &Crref(8, 28));
    vloadC_fp16(C129, &Crref(8, 29));
    vloadC_fp16(C130, &Crref(8, 30));
    vloadC_fp16(C131, &Crref(8, 31));
    vloadC_fp16(C132, &Crref(8, 32));
    vloadC_fp16(C133, &Crref(8, 33));
    vloadC_fp16(C134, &Crref(8, 34));
    vloadC_fp16(C135, &Crref(8, 35));
    vloadC_fp16(C136, &Crref(8, 36));
    vloadC_fp16(C137, &Crref(8, 37));
    vloadC_fp16(C138, &Crref(8, 38));
    vloadC_fp16(C139, &Crref(8, 39));
    vloadC_fp16(C20, &Crref(16, 0));
    vloadC_fp16(C21, &Crref(16, 1));
    vloadC_fp16(C22, &Crref(16, 2));
    vloadC_fp16(C23, &Crref(16, 3));
    vloadC_fp16(C24, &Crref(16, 4));
    vloadC_fp16(C25, &Crref(16, 5));
    vloadC_fp16(C26, &Crref(16, 6));
    vloadC_fp16(C27, &Crref(16, 7));
    vloadC_fp16(C28, &Crref(16, 8));
    vloadC_fp16(C29, &Crref(16, 9));
    vloadC_fp16(C210, &Crref(16, 10));
    vloadC_fp16(C211, &Crref(16, 11));
    vloadC_fp16(C212, &Crref(16, 12));
    vloadC_fp16(C213, &Crref(16, 13));
    vloadC_fp16(C214, &Crref(16, 14));
    vloadC_fp16(C215, &Crref(16, 15));
    vloadC_fp16(C216, &Crref(16, 16));
    vloadC_fp16(C217, &Crref(16, 17));
    vloadC_fp16(C218, &Crref(16, 18));
    vloadC_fp16(C219, &Crref(16, 19));
    vloadC_fp16(C220, &Crref(16, 20));
    vloadC_fp16(C221, &Crref(16, 21));
    vloadC_fp16(C222, &Crref(16, 22));
    vloadC_fp16(C223, &Crref(16, 23));
    vloadC_fp16(C224, &Crref(16, 24));
    vloadC_fp16(C225, &Crref(16, 25));
    vloadC_fp16(C226, &Crref(16, 26));
    vloadC_fp16(C227, &Crref(16, 27));
    vloadC_fp16(C228, &Crref(16, 28));
    vloadC_fp16(C229, &Crref(16, 29));
    vloadC_fp16(C230, &Crref(16, 30));
    vloadC_fp16(C231, &Crref(16, 31));
    vloadC_fp16(C232, &Crref(16, 32));
    vloadC_fp16(C233, &Crref(16, 33));
    vloadC_fp16(C234, &Crref(16, 34));
    vloadC_fp16(C235, &Crref(16, 35));
    vloadC_fp16(C236, &Crref(16, 36));
    vloadC_fp16(C237, &Crref(16, 37));
    vloadC_fp16(C238, &Crref(16, 38));
    vloadC_fp16(C239, &Crref(16, 39));
    vloadC_fp16(C30, &Crref(24, 0));
    vloadC_fp16(C31, &Crref(24, 1));
    vloadC_fp16(C32, &Crref(24, 2));
    vloadC_fp16(C33, &Crref(24, 3));
    vloadC_fp16(C34, &Crref(24, 4));
    vloadC_fp16(C35, &Crref(24, 5));
    vloadC_fp16(C36, &Crref(24, 6));
    vloadC_fp16(C37, &Crref(24, 7));
    vloadC_fp16(C38, &Crref(24, 8));
    vloadC_fp16(C39, &Crref(24, 9));
    vloadC_fp16(C310, &Crref(24, 10));
    vloadC_fp16(C311, &Crref(24, 11));
    vloadC_fp16(C312, &Crref(24, 12));
    vloadC_fp16(C313, &Crref(24, 13));
    vloadC_fp16(C314, &Crref(24, 14));
    vloadC_fp16(C315, &Crref(24, 15));
    vloadC_fp16(C316, &Crref(24, 16));
    vloadC_fp16(C317, &Crref(24, 17));
    vloadC_fp16(C318, &Crref(24, 18));
    vloadC_fp16(C319, &Crref(24, 19));
    vloadC_fp16(C320, &Crref(24, 20));
    vloadC_fp16(C321, &Crref(24, 21));
    vloadC_fp16(C322, &Crref(24, 22));
    vloadC_fp16(C323, &Crref(24, 23));
    vloadC_fp16(C324, &Crref(24, 24));
    vloadC_fp16(C325, &Crref(24, 25));
    vloadC_fp16(C326, &Crref(24, 26));
    vloadC_fp16(C327, &Crref(24, 27));
    vloadC_fp16(C328, &Crref(24, 28));
    vloadC_fp16(C329, &Crref(24, 29));
    vloadC_fp16(C330, &Crref(24, 30));
    vloadC_fp16(C331, &Crref(24, 31));
    vloadC_fp16(C332, &Crref(24, 32));
    vloadC_fp16(C333, &Crref(24, 33));
    vloadC_fp16(C334, &Crref(24, 34));
    vloadC_fp16(C335, &Crref(24, 35));
    vloadC_fp16(C336, &Crref(24, 36));
    vloadC_fp16(C337, &Crref(24, 37));
    vloadC_fp16(C338, &Crref(24, 38));
    vloadC_fp16(C339, &Crref(24, 39));
    vloadC_fp16(C40, &Crref(32, 0));
    vloadC_fp16(C41, &Crref(32, 1));
    vloadC_fp16(C42, &Crref(32, 2));
    vloadC_fp16(C43, &Crref(32, 3));
    vloadC_fp16(C44, &Crref(32, 4));
    vloadC_fp16(C45, &Crref(32, 5));
    vloadC_fp16(C46, &Crref(32, 6));
    vloadC_fp16(C47, &Crref(32, 7));
    vloadC_fp16(C48, &Crref(32, 8));
    vloadC_fp16(C49, &Crref(32, 9));
    vloadC_fp16(C410, &Crref(32, 10));
    vloadC_fp16(C411, &Crref(32, 11));
    vloadC_fp16(C412, &Crref(32, 12));
    vloadC_fp16(C413, &Crref(32, 13));
    vloadC_fp16(C414, &Crref(32, 14));
    vloadC_fp16(C415, &Crref(32, 15));
    vloadC_fp16(C416, &Crref(32, 16));
    vloadC_fp16(C417, &Crref(32, 17));
    vloadC_fp16(C418, &Crref(32, 18));
    vloadC_fp16(C419, &Crref(32, 19));
    vloadC_fp16(C420, &Crref(32, 20));
    vloadC_fp16(C421, &Crref(32, 21));
    vloadC_fp16(C422, &Crref(32, 22));
    vloadC_fp16(C423, &Crref(32, 23));
    vloadC_fp16(C424, &Crref(32, 24));
    vloadC_fp16(C425, &Crref(32, 25));
    vloadC_fp16(C426, &Crref(32, 26));
    vloadC_fp16(C427, &Crref(32, 27));
    vloadC_fp16(C428, &Crref(32, 28));
    vloadC_fp16(C429, &Crref(32, 29));
    vloadC_fp16(C430, &Crref(32, 30));
    vloadC_fp16(C431, &Crref(32, 31));
    vloadC_fp16(C432, &Crref(32, 32));
    vloadC_fp16(C433, &Crref(32, 33));
    vloadC_fp16(C434, &Crref(32, 34));
    vloadC_fp16(C435, &Crref(32, 35));
    vloadC_fp16(C436, &Crref(32, 36));
    vloadC_fp16(C437, &Crref(32, 37));
    vloadC_fp16(C438, &Crref(32, 38));
    vloadC_fp16(C439, &Crref(32, 39));
  }

  for (pr=0; pr<kc; pr++) { // Loop L6
    vload_fp16(A0, &Ar[bA + 0]);
    vload_fp16(A1, &Ar[bA + 8]);
    vload_fp16(A2, &Ar[bA + 16]);
    vload_fp16(A3, &Ar[bA + 24]);
    vload_fp16(A4, &Ar[bA + 32]);
    vload_fp16(B0, &Br[bB + 0]);
    vload_fp16(B1, &Br[bB + 8]);
    vload_fp16(B2, &Br[bB + 16]);
    vload_fp16(B3, &Br[bB + 24]);
    vload_fp16(B4, &Br[bB + 32]);
    vupdate_lane_fp16(C00, A0, B0, 0); 
    vupdate_lane_fp16(C01, A0, B0, 1); 
    vupdate_lane_fp16(C02, A0, B0, 2); 
    vupdate_lane_fp16(C03, A0, B0, 3); 
    vupdate_lane_fp16(C04, A0, B0, 4); 
    vupdate_lane_fp16(C05, A0, B0, 5); 
    vupdate_lane_fp16(C06, A0, B0, 6); 
    vupdate_lane_fp16(C07, A0, B0, 7); 
    vupdate_lane_fp16(C08, A0, B1, 0); 
    vupdate_lane_fp16(C09, A0, B1, 1); 
    vupdate_lane_fp16(C010, A0, B1, 2); 
    vupdate_lane_fp16(C011, A0, B1, 3); 
    vupdate_lane_fp16(C012, A0, B1, 4); 
    vupdate_lane_fp16(C013, A0, B1, 5); 
    vupdate_lane_fp16(C014, A0, B1, 6); 
    vupdate_lane_fp16(C015, A0, B1, 7); 
    vupdate_lane_fp16(C016, A0, B2, 0); 
    vupdate_lane_fp16(C017, A0, B2, 1); 
    vupdate_lane_fp16(C018, A0, B2, 2); 
    vupdate_lane_fp16(C019, A0, B2, 3); 
    vupdate_lane_fp16(C020, A0, B2, 4); 
    vupdate_lane_fp16(C021, A0, B2, 5); 
    vupdate_lane_fp16(C022, A0, B2, 6); 
    vupdate_lane_fp16(C023, A0, B2, 7); 
    vupdate_lane_fp16(C024, A0, B3, 0); 
    vupdate_lane_fp16(C025, A0, B3, 1); 
    vupdate_lane_fp16(C026, A0, B3, 2); 
    vupdate_lane_fp16(C027, A0, B3, 3); 
    vupdate_lane_fp16(C028, A0, B3, 4); 
    vupdate_lane_fp16(C029, A0, B3, 5); 
    vupdate_lane_fp16(C030, A0, B3, 6); 
    vupdate_lane_fp16(C031, A0, B3, 7); 
    vupdate_lane_fp16(C032, A0, B4, 0); 
    vupdate_lane_fp16(C033, A0, B4, 1); 
    vupdate_lane_fp16(C034, A0, B4, 2); 
    vupdate_lane_fp16(C035, A0, B4, 3); 
    vupdate_lane_fp16(C036, A0, B4, 4); 
    vupdate_lane_fp16(C037, A0, B4, 5); 
    vupdate_lane_fp16(C038, A0, B4, 6); 
    vupdate_lane_fp16(C039, A0, B4, 7); 
    vupdate_lane_fp16(C10, A1, B0, 0); 
    vupdate_lane_fp16(C11, A1, B0, 1); 
    vupdate_lane_fp16(C12, A1, B0, 2); 
    vupdate_lane_fp16(C13, A1, B0, 3); 
    vupdate_lane_fp16(C14, A1, B0, 4); 
    vupdate_lane_fp16(C15, A1, B0, 5); 
    vupdate_lane_fp16(C16, A1, B0, 6); 
    vupdate_lane_fp16(C17, A1, B0, 7); 
    vupdate_lane_fp16(C18, A1, B1, 0); 
    vupdate_lane_fp16(C19, A1, B1, 1); 
    vupdate_lane_fp16(C110, A1, B1, 2); 
    vupdate_lane_fp16(C111, A1, B1, 3); 
    vupdate_lane_fp16(C112, A1, B1, 4); 
    vupdate_lane_fp16(C113, A1, B1, 5); 
    vupdate_lane_fp16(C114, A1, B1, 6); 
    vupdate_lane_fp16(C115, A1, B1, 7); 
    vupdate_lane_fp16(C116, A1, B2, 0); 
    vupdate_lane_fp16(C117, A1, B2, 1); 
    vupdate_lane_fp16(C118, A1, B2, 2); 
    vupdate_lane_fp16(C119, A1, B2, 3); 
    vupdate_lane_fp16(C120, A1, B2, 4); 
    vupdate_lane_fp16(C121, A1, B2, 5); 
    vupdate_lane_fp16(C122, A1, B2, 6); 
    vupdate_lane_fp16(C123, A1, B2, 7); 
    vupdate_lane_fp16(C124, A1, B3, 0); 
    vupdate_lane_fp16(C125, A1, B3, 1); 
    vupdate_lane_fp16(C126, A1, B3, 2); 
    vupdate_lane_fp16(C127, A1, B3, 3); 
    vupdate_lane_fp16(C128, A1, B3, 4); 
    vupdate_lane_fp16(C129, A1, B3, 5); 
    vupdate_lane_fp16(C130, A1, B3, 6); 
    vupdate_lane_fp16(C131, A1, B3, 7); 
    vupdate_lane_fp16(C132, A1, B4, 0); 
    vupdate_lane_fp16(C133, A1, B4, 1); 
    vupdate_lane_fp16(C134, A1, B4, 2); 
    vupdate_lane_fp16(C135, A1, B4, 3); 
    vupdate_lane_fp16(C136, A1, B4, 4); 
    vupdate_lane_fp16(C137, A1, B4, 5); 
    vupdate_lane_fp16(C138, A1, B4, 6); 
    vupdate_lane_fp16(C139, A1, B4, 7); 
    vupdate_lane_fp16(C20, A2, B0, 0); 
    vupdate_lane_fp16(C21, A2, B0, 1); 
    vupdate_lane_fp16(C22, A2, B0, 2); 
    vupdate_lane_fp16(C23, A2, B0, 3); 
    vupdate_lane_fp16(C24, A2, B0, 4); 
    vupdate_lane_fp16(C25, A2, B0, 5); 
    vupdate_lane_fp16(C26, A2, B0, 6); 
    vupdate_lane_fp16(C27, A2, B0, 7); 
    vupdate_lane_fp16(C28, A2, B1, 0); 
    vupdate_lane_fp16(C29, A2, B1, 1); 
    vupdate_lane_fp16(C210, A2, B1, 2); 
    vupdate_lane_fp16(C211, A2, B1, 3); 
    vupdate_lane_fp16(C212, A2, B1, 4); 
    vupdate_lane_fp16(C213, A2, B1, 5); 
    vupdate_lane_fp16(C214, A2, B1, 6); 
    vupdate_lane_fp16(C215, A2, B1, 7); 
    vupdate_lane_fp16(C216, A2, B2, 0); 
    vupdate_lane_fp16(C217, A2, B2, 1); 
    vupdate_lane_fp16(C218, A2, B2, 2); 
    vupdate_lane_fp16(C219, A2, B2, 3); 
    vupdate_lane_fp16(C220, A2, B2, 4); 
    vupdate_lane_fp16(C221, A2, B2, 5); 
    vupdate_lane_fp16(C222, A2, B2, 6); 
    vupdate_lane_fp16(C223, A2, B2, 7); 
    vupdate_lane_fp16(C224, A2, B3, 0); 
    vupdate_lane_fp16(C225, A2, B3, 1); 
    vupdate_lane_fp16(C226, A2, B3, 2); 
    vupdate_lane_fp16(C227, A2, B3, 3); 
    vupdate_lane_fp16(C228, A2, B3, 4); 
    vupdate_lane_fp16(C229, A2, B3, 5); 
    vupdate_lane_fp16(C230, A2, B3, 6); 
    vupdate_lane_fp16(C231, A2, B3, 7); 
    vupdate_lane_fp16(C232, A2, B4, 0); 
    vupdate_lane_fp16(C233, A2, B4, 1); 
    vupdate_lane_fp16(C234, A2, B4, 2); 
    vupdate_lane_fp16(C235, A2, B4, 3); 
    vupdate_lane_fp16(C236, A2, B4, 4); 
    vupdate_lane_fp16(C237, A2, B4, 5); 
    vupdate_lane_fp16(C238, A2, B4, 6); 
    vupdate_lane_fp16(C239, A2, B4, 7); 
    vupdate_lane_fp16(C30, A3, B0, 0); 
    vupdate_lane_fp16(C31, A3, B0, 1); 
    vupdate_lane_fp16(C32, A3, B0, 2); 
    vupdate_lane_fp16(C33, A3, B0, 3); 
    vupdate_lane_fp16(C34, A3, B0, 4); 
    vupdate_lane_fp16(C35, A3, B0, 5); 
    vupdate_lane_fp16(C36, A3, B0, 6); 
    vupdate_lane_fp16(C37, A3, B0, 7); 
    vupdate_lane_fp16(C38, A3, B1, 0); 
    vupdate_lane_fp16(C39, A3, B1, 1); 
    vupdate_lane_fp16(C310, A3, B1, 2); 
    vupdate_lane_fp16(C311, A3, B1, 3); 
    vupdate_lane_fp16(C312, A3, B1, 4); 
    vupdate_lane_fp16(C313, A3, B1, 5); 
    vupdate_lane_fp16(C314, A3, B1, 6); 
    vupdate_lane_fp16(C315, A3, B1, 7); 
    vupdate_lane_fp16(C316, A3, B2, 0); 
    vupdate_lane_fp16(C317, A3, B2, 1); 
    vupdate_lane_fp16(C318, A3, B2, 2); 
    vupdate_lane_fp16(C319, A3, B2, 3); 
    vupdate_lane_fp16(C320, A3, B2, 4); 
    vupdate_lane_fp16(C321, A3, B2, 5); 
    vupdate_lane_fp16(C322, A3, B2, 6); 
    vupdate_lane_fp16(C323, A3, B2, 7); 
    vupdate_lane_fp16(C324, A3, B3, 0); 
    vupdate_lane_fp16(C325, A3, B3, 1); 
    vupdate_lane_fp16(C326, A3, B3, 2); 
    vupdate_lane_fp16(C327, A3, B3, 3); 
    vupdate_lane_fp16(C328, A3, B3, 4); 
    vupdate_lane_fp16(C329, A3, B3, 5); 
    vupdate_lane_fp16(C330, A3, B3, 6); 
    vupdate_lane_fp16(C331, A3, B3, 7); 
    vupdate_lane_fp16(C332, A3, B4, 0); 
    vupdate_lane_fp16(C333, A3, B4, 1); 
    vupdate_lane_fp16(C334, A3, B4, 2); 
    vupdate_lane_fp16(C335, A3, B4, 3); 
    vupdate_lane_fp16(C336, A3, B4, 4); 
    vupdate_lane_fp16(C337, A3, B4, 5); 
    vupdate_lane_fp16(C338, A3, B4, 6); 
    vupdate_lane_fp16(C339, A3, B4, 7); 
    vupdate_lane_fp16(C40, A4, B0, 0); 
    vupdate_lane_fp16(C41, A4, B0, 1); 
    vupdate_lane_fp16(C42, A4, B0, 2); 
    vupdate_lane_fp16(C43, A4, B0, 3); 
    vupdate_lane_fp16(C44, A4, B0, 4); 
    vupdate_lane_fp16(C45, A4, B0, 5); 
    vupdate_lane_fp16(C46, A4, B0, 6); 
    vupdate_lane_fp16(C47, A4, B0, 7); 
    vupdate_lane_fp16(C48, A4, B1, 0); 
    vupdate_lane_fp16(C49, A4, B1, 1); 
    vupdate_lane_fp16(C410, A4, B1, 2); 
    vupdate_lane_fp16(C411, A4, B1, 3); 
    vupdate_lane_fp16(C412, A4, B1, 4); 
    vupdate_lane_fp16(C413, A4, B1, 5); 
    vupdate_lane_fp16(C414, A4, B1, 6); 
    vupdate_lane_fp16(C415, A4, B1, 7); 
    vupdate_lane_fp16(C416, A4, B2, 0); 
    vupdate_lane_fp16(C417, A4, B2, 1); 
    vupdate_lane_fp16(C418, A4, B2, 2); 
    vupdate_lane_fp16(C419, A4, B2, 3); 
    vupdate_lane_fp16(C420, A4, B2, 4); 
    vupdate_lane_fp16(C421, A4, B2, 5); 
    vupdate_lane_fp16(C422, A4, B2, 6); 
    vupdate_lane_fp16(C423, A4, B2, 7); 
    vupdate_lane_fp16(C424, A4, B3, 0); 
    vupdate_lane_fp16(C425, A4, B3, 1); 
    vupdate_lane_fp16(C426, A4, B3, 2); 
    vupdate_lane_fp16(C427, A4, B3, 3); 
    vupdate_lane_fp16(C428, A4, B3, 4); 
    vupdate_lane_fp16(C429, A4, B3, 5); 
    vupdate_lane_fp16(C430, A4, B3, 6); 
    vupdate_lane_fp16(C431, A4, B3, 7); 
    vupdate_lane_fp16(C432, A4, B4, 0); 
    vupdate_lane_fp16(C433, A4, B4, 1); 
    vupdate_lane_fp16(C434, A4, B4, 2); 
    vupdate_lane_fp16(C435, A4, B4, 3); 
    vupdate_lane_fp16(C436, A4, B4, 4); 
    vupdate_lane_fp16(C437, A4, B4, 5); 
    vupdate_lane_fp16(C438, A4, B4, 6); 
    vupdate_lane_fp16(C439, A4, B4, 7); 
    bA+=40;
    bB+=40;
  }

  vstoreC_fp16(&Crref(0,0), C00); 
  vstoreC_fp16(&Crref(0,1), C01); 
  vstoreC_fp16(&Crref(0,2), C02); 
  vstoreC_fp16(&Crref(0,3), C03); 
  vstoreC_fp16(&Crref(0,4), C04); 
  vstoreC_fp16(&Crref(0,5), C05); 
  vstoreC_fp16(&Crref(0,6), C06); 
  vstoreC_fp16(&Crref(0,7), C07); 
  vstoreC_fp16(&Crref(0,8), C08); 
  vstoreC_fp16(&Crref(0,9), C09); 
  vstoreC_fp16(&Crref(0,10), C010); 
  vstoreC_fp16(&Crref(0,11), C011); 
  vstoreC_fp16(&Crref(0,12), C012); 
  vstoreC_fp16(&Crref(0,13), C013); 
  vstoreC_fp16(&Crref(0,14), C014); 
  vstoreC_fp16(&Crref(0,15), C015); 
  vstoreC_fp16(&Crref(0,16), C016); 
  vstoreC_fp16(&Crref(0,17), C017); 
  vstoreC_fp16(&Crref(0,18), C018); 
  vstoreC_fp16(&Crref(0,19), C019); 
  vstoreC_fp16(&Crref(0,20), C020); 
  vstoreC_fp16(&Crref(0,21), C021); 
  vstoreC_fp16(&Crref(0,22), C022); 
  vstoreC_fp16(&Crref(0,23), C023); 
  vstoreC_fp16(&Crref(0,24), C024); 
  vstoreC_fp16(&Crref(0,25), C025); 
  vstoreC_fp16(&Crref(0,26), C026); 
  vstoreC_fp16(&Crref(0,27), C027); 
  vstoreC_fp16(&Crref(0,28), C028); 
  vstoreC_fp16(&Crref(0,29), C029); 
  vstoreC_fp16(&Crref(0,30), C030); 
  vstoreC_fp16(&Crref(0,31), C031); 
  vstoreC_fp16(&Crref(0,32), C032); 
  vstoreC_fp16(&Crref(0,33), C033); 
  vstoreC_fp16(&Crref(0,34), C034); 
  vstoreC_fp16(&Crref(0,35), C035); 
  vstoreC_fp16(&Crref(0,36), C036); 
  vstoreC_fp16(&Crref(0,37), C037); 
  vstoreC_fp16(&Crref(0,38), C038); 
  vstoreC_fp16(&Crref(0,39), C039); 
  vstoreC_fp16(&Crref(8,0), C10); 
  vstoreC_fp16(&Crref(8,1), C11); 
  vstoreC_fp16(&Crref(8,2), C12); 
  vstoreC_fp16(&Crref(8,3), C13); 
  vstoreC_fp16(&Crref(8,4), C14); 
  vstoreC_fp16(&Crref(8,5), C15); 
  vstoreC_fp16(&Crref(8,6), C16); 
  vstoreC_fp16(&Crref(8,7), C17); 
  vstoreC_fp16(&Crref(8,8), C18); 
  vstoreC_fp16(&Crref(8,9), C19); 
  vstoreC_fp16(&Crref(8,10), C110); 
  vstoreC_fp16(&Crref(8,11), C111); 
  vstoreC_fp16(&Crref(8,12), C112); 
  vstoreC_fp16(&Crref(8,13), C113); 
  vstoreC_fp16(&Crref(8,14), C114); 
  vstoreC_fp16(&Crref(8,15), C115); 
  vstoreC_fp16(&Crref(8,16), C116); 
  vstoreC_fp16(&Crref(8,17), C117); 
  vstoreC_fp16(&Crref(8,18), C118); 
  vstoreC_fp16(&Crref(8,19), C119); 
  vstoreC_fp16(&Crref(8,20), C120); 
  vstoreC_fp16(&Crref(8,21), C121); 
  vstoreC_fp16(&Crref(8,22), C122); 
  vstoreC_fp16(&Crref(8,23), C123); 
  vstoreC_fp16(&Crref(8,24), C124); 
  vstoreC_fp16(&Crref(8,25), C125); 
  vstoreC_fp16(&Crref(8,26), C126); 
  vstoreC_fp16(&Crref(8,27), C127); 
  vstoreC_fp16(&Crref(8,28), C128); 
  vstoreC_fp16(&Crref(8,29), C129); 
  vstoreC_fp16(&Crref(8,30), C130); 
  vstoreC_fp16(&Crref(8,31), C131); 
  vstoreC_fp16(&Crref(8,32), C132); 
  vstoreC_fp16(&Crref(8,33), C133); 
  vstoreC_fp16(&Crref(8,34), C134); 
  vstoreC_fp16(&Crref(8,35), C135); 
  vstoreC_fp16(&Crref(8,36), C136); 
  vstoreC_fp16(&Crref(8,37), C137); 
  vstoreC_fp16(&Crref(8,38), C138); 
  vstoreC_fp16(&Crref(8,39), C139); 
  vstoreC_fp16(&Crref(16,0), C20); 
  vstoreC_fp16(&Crref(16,1), C21); 
  vstoreC_fp16(&Crref(16,2), C22); 
  vstoreC_fp16(&Crref(16,3), C23); 
  vstoreC_fp16(&Crref(16,4), C24); 
  vstoreC_fp16(&Crref(16,5), C25); 
  vstoreC_fp16(&Crref(16,6), C26); 
  vstoreC_fp16(&Crref(16,7), C27); 
  vstoreC_fp16(&Crref(16,8), C28); 
  vstoreC_fp16(&Crref(16,9), C29); 
  vstoreC_fp16(&Crref(16,10), C210); 
  vstoreC_fp16(&Crref(16,11), C211); 
  vstoreC_fp16(&Crref(16,12), C212); 
  vstoreC_fp16(&Crref(16,13), C213); 
  vstoreC_fp16(&Crref(16,14), C214); 
  vstoreC_fp16(&Crref(16,15), C215); 
  vstoreC_fp16(&Crref(16,16), C216); 
  vstoreC_fp16(&Crref(16,17), C217); 
  vstoreC_fp16(&Crref(16,18), C218); 
  vstoreC_fp16(&Crref(16,19), C219); 
  vstoreC_fp16(&Crref(16,20), C220); 
  vstoreC_fp16(&Crref(16,21), C221); 
  vstoreC_fp16(&Crref(16,22), C222); 
  vstoreC_fp16(&Crref(16,23), C223); 
  vstoreC_fp16(&Crref(16,24), C224); 
  vstoreC_fp16(&Crref(16,25), C225); 
  vstoreC_fp16(&Crref(16,26), C226); 
  vstoreC_fp16(&Crref(16,27), C227); 
  vstoreC_fp16(&Crref(16,28), C228); 
  vstoreC_fp16(&Crref(16,29), C229); 
  vstoreC_fp16(&Crref(16,30), C230); 
  vstoreC_fp16(&Crref(16,31), C231); 
  vstoreC_fp16(&Crref(16,32), C232); 
  vstoreC_fp16(&Crref(16,33), C233); 
  vstoreC_fp16(&Crref(16,34), C234); 
  vstoreC_fp16(&Crref(16,35), C235); 
  vstoreC_fp16(&Crref(16,36), C236); 
  vstoreC_fp16(&Crref(16,37), C237); 
  vstoreC_fp16(&Crref(16,38), C238); 
  vstoreC_fp16(&Crref(16,39), C239); 
  vstoreC_fp16(&Crref(24,0), C30); 
  vstoreC_fp16(&Crref(24,1), C31); 
  vstoreC_fp16(&Crref(24,2), C32); 
  vstoreC_fp16(&Crref(24,3), C33); 
  vstoreC_fp16(&Crref(24,4), C34); 
  vstoreC_fp16(&Crref(24,5), C35); 
  vstoreC_fp16(&Crref(24,6), C36); 
  vstoreC_fp16(&Crref(24,7), C37); 
  vstoreC_fp16(&Crref(24,8), C38); 
  vstoreC_fp16(&Crref(24,9), C39); 
  vstoreC_fp16(&Crref(24,10), C310); 
  vstoreC_fp16(&Crref(24,11), C311); 
  vstoreC_fp16(&Crref(24,12), C312); 
  vstoreC_fp16(&Crref(24,13), C313); 
  vstoreC_fp16(&Crref(24,14), C314); 
  vstoreC_fp16(&Crref(24,15), C315); 
  vstoreC_fp16(&Crref(24,16), C316); 
  vstoreC_fp16(&Crref(24,17), C317); 
  vstoreC_fp16(&Crref(24,18), C318); 
  vstoreC_fp16(&Crref(24,19), C319); 
  vstoreC_fp16(&Crref(24,20), C320); 
  vstoreC_fp16(&Crref(24,21), C321); 
  vstoreC_fp16(&Crref(24,22), C322); 
  vstoreC_fp16(&Crref(24,23), C323); 
  vstoreC_fp16(&Crref(24,24), C324); 
  vstoreC_fp16(&Crref(24,25), C325); 
  vstoreC_fp16(&Crref(24,26), C326); 
  vstoreC_fp16(&Crref(24,27), C327); 
  vstoreC_fp16(&Crref(24,28), C328); 
  vstoreC_fp16(&Crref(24,29), C329); 
  vstoreC_fp16(&Crref(24,30), C330); 
  vstoreC_fp16(&Crref(24,31), C331); 
  vstoreC_fp16(&Crref(24,32), C332); 
  vstoreC_fp16(&Crref(24,33), C333); 
  vstoreC_fp16(&Crref(24,34), C334); 
  vstoreC_fp16(&Crref(24,35), C335); 
  vstoreC_fp16(&Crref(24,36), C336); 
  vstoreC_fp16(&Crref(24,37), C337); 
  vstoreC_fp16(&Crref(24,38), C338); 
  vstoreC_fp16(&Crref(24,39), C339); 
  vstoreC_fp16(&Crref(32,0), C40); 
  vstoreC_fp16(&Crref(32,1), C41); 
  vstoreC_fp16(&Crref(32,2), C42); 
  vstoreC_fp16(&Crref(32,3), C43); 
  vstoreC_fp16(&Crref(32,4), C44); 
  vstoreC_fp16(&Crref(32,5), C45); 
  vstoreC_fp16(&Crref(32,6), C46); 
  vstoreC_fp16(&Crref(32,7), C47); 
  vstoreC_fp16(&Crref(32,8), C48); 
  vstoreC_fp16(&Crref(32,9), C49); 
  vstoreC_fp16(&Crref(32,10), C410); 
  vstoreC_fp16(&Crref(32,11), C411); 
  vstoreC_fp16(&Crref(32,12), C412); 
  vstoreC_fp16(&Crref(32,13), C413); 
  vstoreC_fp16(&Crref(32,14), C414); 
  vstoreC_fp16(&Crref(32,15), C415); 
  vstoreC_fp16(&Crref(32,16), C416); 
  vstoreC_fp16(&Crref(32,17), C417); 
  vstoreC_fp16(&Crref(32,18), C418); 
  vstoreC_fp16(&Crref(32,19), C419); 
  vstoreC_fp16(&Crref(32,20), C420); 
  vstoreC_fp16(&Crref(32,21), C421); 
  vstoreC_fp16(&Crref(32,22), C422); 
  vstoreC_fp16(&Crref(32,23), C423); 
  vstoreC_fp16(&Crref(32,24), C424); 
  vstoreC_fp16(&Crref(32,25), C425); 
  vstoreC_fp16(&Crref(32,26), C426); 
  vstoreC_fp16(&Crref(32,27), C427); 
  vstoreC_fp16(&Crref(32,28), C428); 
  vstoreC_fp16(&Crref(32,29), C429); 
  vstoreC_fp16(&Crref(32,30), C430); 
  vstoreC_fp16(&Crref(32,31), C431); 
  vstoreC_fp16(&Crref(32,32), C432); 
  vstoreC_fp16(&Crref(32,33), C433); 
  vstoreC_fp16(&Crref(32,34), C434); 
  vstoreC_fp16(&Crref(32,35), C435); 
  vstoreC_fp16(&Crref(32,36), C436); 
  vstoreC_fp16(&Crref(32,37), C437); 
  vstoreC_fp16(&Crref(32,38), C438); 
  vstoreC_fp16(&Crref(32,39), C439); 
}

uk_intrinsic_fp16 *new_uk_intrinsic_selector_fp16() { 
  uk_intrinsic_fp16 *uk_vec = (uk_intrinsic_fp16 *)malloc(sizeof(uk_intrinsic_fp16) * 41 * 41);
  uk_vec[8*41 + 8] = ukernel_intrinsic_8x8_fp16;
  uk_vec[16*41 + 8] = ukernel_intrinsic_8x16_fp16;
  uk_vec[24*41 + 8] = ukernel_intrinsic_8x24_fp16;
  uk_vec[32*41 + 8] = ukernel_intrinsic_8x32_fp16;
  uk_vec[40*41 + 8] = ukernel_intrinsic_8x40_fp16;
  uk_vec[8*41 + 16] = ukernel_intrinsic_16x8_fp16;
  uk_vec[16*41 + 16] = ukernel_intrinsic_16x16_fp16;
  uk_vec[24*41 + 16] = ukernel_intrinsic_16x24_fp16;
  uk_vec[32*41 + 16] = ukernel_intrinsic_16x32_fp16;
  uk_vec[40*41 + 16] = ukernel_intrinsic_16x40_fp16;
  uk_vec[8*41 + 24] = ukernel_intrinsic_24x8_fp16;
  uk_vec[16*41 + 24] = ukernel_intrinsic_24x16_fp16;
  uk_vec[24*41 + 24] = ukernel_intrinsic_24x24_fp16;
  uk_vec[32*41 + 24] = ukernel_intrinsic_24x32_fp16;
  uk_vec[40*41 + 24] = ukernel_intrinsic_24x40_fp16;
  uk_vec[8*41 + 32] = ukernel_intrinsic_32x8_fp16;
  uk_vec[16*41 + 32] = ukernel_intrinsic_32x16_fp16;
  uk_vec[24*41 + 32] = ukernel_intrinsic_32x24_fp16;
  uk_vec[32*41 + 32] = ukernel_intrinsic_32x32_fp16;
  uk_vec[40*41 + 32] = ukernel_intrinsic_32x40_fp16;
  uk_vec[8*41 + 40] = ukernel_intrinsic_40x8_fp16;
  uk_vec[16*41 + 40] = ukernel_intrinsic_40x16_fp16;
  uk_vec[24*41 + 40] = ukernel_intrinsic_40x24_fp16;
  uk_vec[32*41 + 40] = ukernel_intrinsic_40x32_fp16;
  uk_vec[40*41 + 40] = ukernel_intrinsic_40x40_fp16;
  return uk_vec;
}

void uk_intrinsic_selector_fp16(int mr, int nr, uk_intrinsic_fp16 *uk_vec, uk_intrinsic_fp16 *ukr) {
  (*ukr) = uk_vec[nr*41 + mr];
}
